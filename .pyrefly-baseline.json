{
  "errors": [
    {
      "line": 162,
      "column": 14,
      "stop_line": 162,
      "stop_column": 120,
      "path": "lib/levanter/examples/alpaca/alpaca.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`BatchEncoding` is not assignable to variable `ex` with type `dict[Unknown, Unknown]`",
      "concise_description": "`BatchEncoding` is not assignable to variable `ex` with type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 112,
      "column": 14,
      "stop_line": 112,
      "stop_column": 120,
      "path": "lib/levanter/examples/gsm8k-lora/gsm8k_lora.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`BatchEncoding` is not assignable to variable `ex` with type `dict[Unknown, Unknown]`",
      "concise_description": "`BatchEncoding` is not assignable to variable `ex` with type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 97,
      "column": 38,
      "stop_line": 97,
      "stop_column": 61,
      "path": "lib/levanter/src/levanter/analysis/tree_stats.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, Array | Histogram]`\n  Argument `Array | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]` is not assignable to parameter `value` with type `Array | Histogram` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, Array | Histogram]`",
      "severity": "error"
    },
    {
      "line": 26,
      "column": 50,
      "stop_line": 26,
      "stop_column": 112,
      "path": "lib/levanter/src/levanter/callbacks/watch.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`list[str]` is not assignable to `Literal['grads', 'opt_state', 'params', 'updates'] | list[Literal['grads', 'opt_state', 'params', 'updates']]`",
      "concise_description": "`list[str]` is not assignable to `Literal['grads', 'opt_state', 'params', 'updates'] | list[Literal['grads', 'opt_state', 'params', 'updates']]`",
      "severity": "error"
    },
    {
      "line": 305,
      "column": 46,
      "stop_line": 305,
      "stop_column": 56,
      "path": "lib/levanter/src/levanter/checkpoint.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`str` is not assignable to attribute `_checkpoint_being_removed` with type `None`",
      "concise_description": "`str` is not assignable to attribute `_checkpoint_being_removed` with type `None`",
      "severity": "error"
    },
    {
      "line": 523,
      "column": 29,
      "stop_line": 523,
      "stop_column": 46,
      "path": "lib/levanter/src/levanter/checkpoint.py",
      "code": -2,
      "name": "invalid-param-spec",
      "description": "Expected *-unpacked Sig.args and **-unpacked Sig.kwargs",
      "concise_description": "Expected *-unpacked Sig.args and **-unpacked Sig.kwargs",
      "severity": "error"
    },
    {
      "line": 560,
      "column": 12,
      "stop_line": 560,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/checkpoint.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `(*args: Unknown, **kwargs: Unknown) -> M` is not assignable to declared return type `(ParamSpec(Sig)) -> M`",
      "concise_description": "Returned type `(*args: Unknown, **kwargs: Unknown) -> M` is not assignable to declared return type `(ParamSpec(Sig)) -> M`",
      "severity": "error"
    },
    {
      "line": 66,
      "column": 15,
      "stop_line": 66,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/compat/fsspec_safetensor.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `_AsyncifyingFileSystemWrapper._cat_file` overrides parent class `AsyncFileSystem` in an inconsistent manner\n  `_AsyncifyingFileSystemWrapper._cat_file` has type `BoundMethod[_AsyncifyingFileSystemWrapper, (self: _AsyncifyingFileSystemWrapper, path: str, start: int | None = None, end: int | None = None, **kwargs: Unknown) -> Coroutine[Unknown, Unknown, bytes]]`, which is not assignable to `BoundMethod[_AsyncifyingFileSystemWrapper, (self: _AsyncifyingFileSystemWrapper, path: Unknown, start: Unknown | None = None, end: Unknown | None = None, **kwargs: Unknown) -> Coroutine[Unknown, Unknown, Never]]`, the type of `AsyncFileSystem._cat_file`",
      "concise_description": "Class member `_AsyncifyingFileSystemWrapper._cat_file` overrides parent class `AsyncFileSystem` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 401,
      "column": 32,
      "stop_line": 401,
      "stop_column": 92,
      "path": "lib/levanter/src/levanter/compat/hf_checkpoints.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`MutableMapping[Unknown, Unknown]` is not assignable to variable `config_overrides` with type `dict[Unknown, Unknown]`",
      "concise_description": "`MutableMapping[Unknown, Unknown]` is not assignable to variable `config_overrides` with type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 493,
      "column": 16,
      "stop_line": 493,
      "stop_column": 22,
      "path": "lib/levanter/src/levanter/compat/hf_checkpoints.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `None` is not assignable to declared return type `LevConfig`",
      "concise_description": "Returned type `None` is not assignable to declared return type `LevConfig`",
      "severity": "error"
    },
    {
      "line": 555,
      "column": 20,
      "stop_line": 555,
      "stop_column": 30,
      "path": "lib/levanter/src/levanter/compat/hf_checkpoints.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[Unknown, Unknown] | None` is not assignable to declared return type `dict[Unknown, Unknown]`",
      "concise_description": "Returned type `dict[Unknown, Unknown] | None` is not assignable to declared return type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 1100,
      "column": 16,
      "stop_line": 1102,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/compat/hf_checkpoints.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `ImageProcessingMixin | tuple[ImageProcessingMixin, Unknown] | Unknown` is not assignable to declared return type `ProcessorMixin`",
      "concise_description": "Returned type `ImageProcessingMixin | tuple[ImageProcessingMixin, Unknown] | Unknown` is not assignable to declared return type `ProcessorMixin`",
      "severity": "error"
    },
    {
      "line": 1227,
      "column": 40,
      "stop_line": 1227,
      "stop_column": 46,
      "path": "lib/levanter/src/levanter/compat/hf_checkpoints.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, Array]`\n  Argument `Array | ShapeDtypeStruct` is not assignable to parameter `value` with type `Array` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, Array]`",
      "severity": "error"
    },
    {
      "line": 110,
      "column": 20,
      "stop_line": 110,
      "stop_column": 22,
      "path": "lib/levanter/src/levanter/config.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 48,
      "column": 54,
      "stop_line": 48,
      "stop_column": 70,
      "path": "lib/levanter/src/levanter/data/_prp.py",
      "code": -2,
      "name": "bad-return",
      "description": "Function declared to return `int | ndarray[tuple[Any, ...], dtype[Any]]` but is missing an explicit `return`",
      "concise_description": "Function declared to return `int | ndarray[tuple[Any, ...], dtype[Any]]` but is missing an explicit `return`",
      "severity": "error"
    },
    {
      "line": 110,
      "column": 40,
      "stop_line": 110,
      "stop_column": 62,
      "path": "lib/levanter/src/levanter/data/audio.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `SequenceFeatureExtractor`",
      "concise_description": "Expected a callable, got `SequenceFeatureExtractor`",
      "severity": "error"
    },
    {
      "line": 138,
      "column": 9,
      "stop_line": 138,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/data/audio.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `BatchAudioProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `BatchAudioProcessor.output_exemplar` has type `BoundMethod[BatchAudioProcessor, (self: BatchAudioProcessor) -> dict[str, ndarray[tuple[int], dtype[signedinteger[_32Bit]]] | ndarray[tuple[int, int], dtype[floating[_32Bit]]]]]`, which is not assignable to `BoundMethod[BatchAudioProcessor, (self: BatchAudioProcessor) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `BatchAudioProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 378,
      "column": 9,
      "stop_line": 378,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/data/audio.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `AudioIODatasetConfig.validation_sets` overrides parent class `AudioTaskConfig` in an inconsistent manner\n  `AudioIODatasetConfig.validation_sets` has type `BoundMethod[AudioIODatasetConfig, (self: AudioIODatasetConfig, monitors: bool | list[MetricsMonitor] = True) -> Mapping[str, ProcessedAudioCache]]`, which is not assignable to `BoundMethod[AudioIODatasetConfig, (self: AudioIODatasetConfig, monitors: bool | list[MetricsMonitor] = True) -> Mapping[str, AsyncDataset[ndarray[tuple[Any, ...], dtype[Any]]]]]`, the type of `AudioTaskConfig.validation_sets`",
      "concise_description": "Class member `AudioIODatasetConfig.validation_sets` overrides parent class `AudioTaskConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 563,
      "column": 16,
      "stop_line": 563,
      "stop_column": 26,
      "path": "lib/levanter/src/levanter/data/audio.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[str, ProcessedAudioCache]` is not assignable to declared return type `Mapping[str, AsyncDataset[ndarray[tuple[Any, ...], dtype[Any]]]]`",
      "concise_description": "Returned type `dict[str, ProcessedAudioCache]` is not assignable to declared return type `Mapping[str, AsyncDataset[ndarray[tuple[Any, ...], dtype[Any]]]]`",
      "severity": "error"
    },
    {
      "line": 464,
      "column": 14,
      "stop_line": 464,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/data/dataset.py",
      "code": -2,
      "name": "invalid-type-var",
      "description": "Attribute `dataset` cannot depend on type variable `T`, which is not in the scope of class `BatchMappedAsyncDataset`",
      "concise_description": "Attribute `dataset` cannot depend on type variable `T`, which is not in the scope of class `BatchMappedAsyncDataset`",
      "severity": "error"
    },
    {
      "line": 146,
      "column": 16,
      "stop_line": 146,
      "stop_column": 43,
      "path": "lib/levanter/src/levanter/data/loader.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`%` is not supported between `int` and `None`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__mod__`",
      "concise_description": "`%` is not supported between `int` and `None`",
      "severity": "error"
    },
    {
      "line": 307,
      "column": 17,
      "stop_line": 309,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/data/loader.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`_Batch[Ex] | Ex` is not assignable to `_Batch[Ex]` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`_Batch[Ex] | Ex` is not assignable to `_Batch[Ex]` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 542,
      "column": 26,
      "stop_line": 542,
      "stop_column": 52,
      "path": "lib/levanter/src/levanter/data/loader.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+` is not supported between `tuple[Unknown]` and `dict[str, int]`\n  No matching overload found for function `tuple.__add__` called with arguments: (dict[str, int])\n  Possible overloads:\n  (value: tuple[Unknown, ...], /) -> tuple[Unknown, ...] [closest match]\n  (value: tuple[_T, ...], /) -> tuple[_T | Unknown, ...]",
      "concise_description": "`+` is not supported between `tuple[Unknown]` and `dict[str, int]`",
      "severity": "error"
    },
    {
      "line": 249,
      "column": 18,
      "stop_line": 249,
      "stop_column": 43,
      "path": "lib/levanter/src/levanter/data/mixture.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 282,
      "column": 69,
      "stop_line": 282,
      "stop_column": 88,
      "path": "lib/levanter/src/levanter/data/mixture.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 373,
      "column": 5,
      "stop_line": 377,
      "stop_column": 83,
      "path": "lib/levanter/src/levanter/data/packing.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`int | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`int | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 24,
      "column": 9,
      "stop_line": 24,
      "stop_column": 18,
      "path": "lib/levanter/src/levanter/data/passthrough_tokenizer.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `PassthroughTokenizer.get_vocab` overrides parent class `PreTrainedTokenizer` in an inconsistent manner\n  `PassthroughTokenizer.get_vocab` has type `BoundMethod[PassthroughTokenizer, (self: PassthroughTokenizer) -> dict[int, int]]`, which is not assignable to `BoundMethod[PassthroughTokenizer, (self: PassthroughTokenizer) -> dict[str, int]]`, the type of `PreTrainedTokenizer.get_vocab`",
      "concise_description": "Class member `PassthroughTokenizer.get_vocab` overrides parent class `PreTrainedTokenizer` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 30,
      "column": 9,
      "stop_line": 30,
      "stop_column": 18,
      "path": "lib/levanter/src/levanter/data/passthrough_tokenizer.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `PassthroughTokenizer._tokenize` overrides parent class `PreTrainedTokenizer` in an inconsistent manner\n  `PassthroughTokenizer._tokenize` has type `BoundMethod[PassthroughTokenizer, (self: PassthroughTokenizer, text: Unknown, **kwargs: Unknown) -> ndarray[tuple[Any, ...], dtype[Any]]]`, which is not assignable to `BoundMethod[PassthroughTokenizer, (self: PassthroughTokenizer, text: Unknown, **kwargs: Unknown) -> Never]`, the type of `PreTrainedTokenizer._tokenize`",
      "concise_description": "Class member `PassthroughTokenizer._tokenize` overrides parent class `PreTrainedTokenizer` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 34,
      "column": 9,
      "stop_line": 34,
      "stop_column": 29,
      "path": "lib/levanter/src/levanter/data/passthrough_tokenizer.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `PassthroughTokenizer._convert_token_to_id` overrides parent class `PreTrainedTokenizer` in an inconsistent manner\n  `PassthroughTokenizer._convert_token_to_id` has type `BoundMethod[PassthroughTokenizer, (self: PassthroughTokenizer, token: str) -> int]`, which is not assignable to `BoundMethod[PassthroughTokenizer, (self: PassthroughTokenizer, token: Unknown) -> Never]`, the type of `PreTrainedTokenizer._convert_token_to_id`",
      "concise_description": "Class member `PassthroughTokenizer._convert_token_to_id` overrides parent class `PreTrainedTokenizer` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 83,
      "column": 69,
      "stop_line": 83,
      "stop_column": 87,
      "path": "lib/levanter/src/levanter/data/permutation.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 101,
      "column": 9,
      "stop_line": 101,
      "stop_column": 33,
      "path": "lib/levanter/src/levanter/data/permutation.py",
      "code": -2,
      "name": "read-only",
      "description": "Attribute `gen_era_permutation` of class `EraShufflingDataset` is a read-only descriptor with no `__set__` and cannot be set",
      "concise_description": "Attribute `gen_era_permutation` of class `EraShufflingDataset` is a read-only descriptor with no `__set__` and cannot be set",
      "severity": "error"
    },
    {
      "line": 117,
      "column": 16,
      "stop_line": 117,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/data/sharded_datasource.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `TreeCache[Unknown]` is not assignable to declared return type `AsyncDataset[T]`",
      "concise_description": "Returned type `TreeCache[Unknown]` is not assignable to declared return type `AsyncDataset[T]`",
      "severity": "error"
    },
    {
      "line": 236,
      "column": 23,
      "stop_line": 236,
      "stop_column": 26,
      "path": "lib/levanter/src/levanter/data/sharded_datasource.py",
      "code": -2,
      "name": "invalid-yield",
      "description": "Type of yielded value `Mapping[Unknown, Unknown] | dict[Unknown, Unknown] | list[Unknown] | Unknown` is not assignable to declared return type `dict[Unknown, Unknown]`",
      "concise_description": "Type of yielded value `Mapping[Unknown, Unknown] | dict[Unknown, Unknown] | list[Unknown] | Unknown` is not assignable to declared return type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 582,
      "column": 14,
      "stop_line": 582,
      "stop_column": 16,
      "path": "lib/levanter/src/levanter/data/sharded_datasource.py",
      "code": -2,
      "name": "invalid-type-var",
      "description": "Attribute `fn` cannot depend on type variable `T_co`, which is not in the scope of class `_MappedShardedDataSource`",
      "concise_description": "Attribute `fn` cannot depend on type variable `T_co`, which is not in the scope of class `_MappedShardedDataSource`",
      "severity": "error"
    },
    {
      "line": 327,
      "column": 9,
      "stop_line": 327,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `BatchTokenizer.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `BatchTokenizer.output_exemplar` has type `BoundMethod[BatchTokenizer, (self: BatchTokenizer) -> dict[Unknown, Unknown]]`, which is not assignable to `BoundMethod[BatchTokenizer, (self: BatchTokenizer) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `BatchTokenizer.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 659,
      "column": 5,
      "stop_line": 659,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedHfSourceConfig.cache_dir` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner\n  `SupervisedHfSourceConfig.cache_dir` is read-only, but `SupervisedSourceConfigBase.cache_dir` is read-write",
      "concise_description": "Class member `SupervisedHfSourceConfig.cache_dir` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 665,
      "column": 5,
      "stop_line": 665,
      "stop_column": 16,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedHfSourceConfig.input_field` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner\n  `SupervisedHfSourceConfig.input_field` is read-only, but `SupervisedSourceConfigBase.input_field` is read-write",
      "concise_description": "Class member `SupervisedHfSourceConfig.input_field` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 666,
      "column": 5,
      "stop_line": 666,
      "stop_column": 17,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedHfSourceConfig.output_field` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner\n  `SupervisedHfSourceConfig.output_field` is read-only, but `SupervisedSourceConfigBase.output_field` is read-write",
      "concise_description": "Class member `SupervisedHfSourceConfig.output_field` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 667,
      "column": 5,
      "stop_line": 667,
      "stop_column": 9,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedHfSourceConfig.tags` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner\n  `SupervisedHfSourceConfig.tags` is read-only, but `SupervisedSourceConfigBase.tags` is read-write",
      "concise_description": "Class member `SupervisedHfSourceConfig.tags` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 677,
      "column": 5,
      "stop_line": 677,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedUrlSourceConfig.cache_dir` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner\n  `SupervisedUrlSourceConfig.cache_dir` is read-only, but `SupervisedSourceConfigBase.cache_dir` is read-write",
      "concise_description": "Class member `SupervisedUrlSourceConfig.cache_dir` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 681,
      "column": 5,
      "stop_line": 681,
      "stop_column": 16,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedUrlSourceConfig.input_field` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner\n  `SupervisedUrlSourceConfig.input_field` is read-only, but `SupervisedSourceConfigBase.input_field` is read-write",
      "concise_description": "Class member `SupervisedUrlSourceConfig.input_field` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 682,
      "column": 5,
      "stop_line": 682,
      "stop_column": 17,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedUrlSourceConfig.output_field` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner\n  `SupervisedUrlSourceConfig.output_field` is read-only, but `SupervisedSourceConfigBase.output_field` is read-write",
      "concise_description": "Class member `SupervisedUrlSourceConfig.output_field` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 683,
      "column": 5,
      "stop_line": 683,
      "stop_column": 9,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedUrlSourceConfig.tags` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner\n  `SupervisedUrlSourceConfig.tags` is read-only, but `SupervisedSourceConfigBase.tags` is read-write",
      "concise_description": "Class member `SupervisedUrlSourceConfig.tags` overrides parent class `SupervisedSourceConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 1504,
      "column": 9,
      "stop_line": 1504,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ChatProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `ChatProcessor.output_exemplar` has type `BoundMethod[ChatProcessor, (self: ChatProcessor) -> dict[str, ndarray[tuple[int], dtype[signedinteger[_32Bit]]]]]`, which is not assignable to `BoundMethod[ChatProcessor, (self: ChatProcessor) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `ChatProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 1608,
      "column": 29,
      "stop_line": 1608,
      "stop_column": 75,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`list[str] | str` is not assignable to variable `separate_with` with type `int | str | None`",
      "concise_description": "`list[str] | str` is not assignable to variable `separate_with` with type `int | str | None`",
      "severity": "error"
    },
    {
      "line": 1630,
      "column": 9,
      "stop_line": 1630,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SupervisedProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `SupervisedProcessor.output_exemplar` has type `BoundMethod[SupervisedProcessor, (self: SupervisedProcessor) -> dict[str, ndarray[tuple[int], dtype[signedinteger[_32Bit]]]]]`, which is not assignable to `BoundMethod[SupervisedProcessor, (self: SupervisedProcessor) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `SupervisedProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 1761,
      "column": 9,
      "stop_line": 1761,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/data/text.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SingleTurnChatProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `SingleTurnChatProcessor.output_exemplar` has type `BoundMethod[SingleTurnChatProcessor, (self: SingleTurnChatProcessor) -> dict[str, ndarray[tuple[int], dtype[signedinteger[_32Bit]]]]]`, which is not assignable to `BoundMethod[SingleTurnChatProcessor, (self: SingleTurnChatProcessor) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `SingleTurnChatProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 112,
      "column": 15,
      "stop_line": 112,
      "stop_column": 28,
      "path": "lib/levanter/src/levanter/eval.py",
      "code": -2,
      "name": "bad-param-name-override",
      "description": "Class member `DomainTaggedDataset.getitem_async` overrides parent class `AsyncDataset` in an inconsistent manner\n  Got parameter name `item`, expected `index`",
      "concise_description": "Class member `DomainTaggedDataset.getitem_async` overrides parent class `AsyncDataset` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 146,
      "column": 16,
      "stop_line": 146,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/eval.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `list[list[Unknown]]` is not assignable to declared return type `Sequence[tuple[T, NamedArray]]`",
      "concise_description": "Returned type `list[list[Unknown]]` is not assignable to declared return type `Sequence[tuple[T, NamedArray]]`",
      "severity": "error"
    },
    {
      "line": 170,
      "column": 37,
      "stop_line": 170,
      "stop_column": 41,
      "path": "lib/levanter/src/levanter/eval.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `None` is not assignable to parameter `axis_mapping` with type `Mapping[str, Sequence[str] | str]`",
      "concise_description": "Default `None` is not assignable to parameter `axis_mapping` with type `Mapping[str, Sequence[str] | str]`",
      "severity": "error"
    },
    {
      "line": 175,
      "column": 22,
      "stop_line": 175,
      "stop_column": 26,
      "path": "lib/levanter/src/levanter/eval.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `None` is not assignable to parameter `mp` with type `Policy`",
      "concise_description": "Default `None` is not assignable to parameter `mp` with type `Policy`",
      "severity": "error"
    },
    {
      "line": 480,
      "column": 19,
      "stop_line": 480,
      "stop_column": 50,
      "path": "lib/levanter/src/levanter/eval.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`RunningMean` is not assignable to variable `per_tag` with type `Array | NamedArray | ndarray[tuple[Any, ...], dtype[Any]]`",
      "concise_description": "`RunningMean` is not assignable to variable `per_tag` with type `Array | NamedArray | ndarray[tuple[Any, ...], dtype[Any]]`",
      "severity": "error"
    },
    {
      "line": 337,
      "column": 25,
      "stop_line": 337,
      "stop_column": 35,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "invalid-inheritance",
      "description": "Invalid base class: `object | Unknown`",
      "concise_description": "Invalid base class: `object | Unknown`",
      "severity": "error"
    },
    {
      "line": 611,
      "column": 55,
      "stop_line": 611,
      "stop_column": 69,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `property`",
      "concise_description": "Expected a callable, got `property`",
      "severity": "error"
    },
    {
      "line": 642,
      "column": 27,
      "stop_line": 642,
      "stop_column": 48,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 825,
      "column": 24,
      "stop_line": 825,
      "stop_column": 50,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 1211,
      "column": 22,
      "stop_line": 1211,
      "stop_column": 36,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `levanter.utils` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `levanter.utils` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 1211,
      "column": 22,
      "stop_line": 1211,
      "stop_column": 46,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `levanter.utils.jax_utils` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `levanter.utils.jax_utils` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 1236,
      "column": 24,
      "stop_line": 1236,
      "stop_column": 55,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Mapping[Unknown, Unknown] | dict[Unknown, Unknown]` is not assignable to variable `tasks_to_run` with type `dict[Unknown, Unknown]`",
      "concise_description": "`Mapping[Unknown, Unknown] | dict[Unknown, Unknown]` is not assignable to variable `tasks_to_run` with type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 1367,
      "column": 28,
      "stop_line": 1367,
      "stop_column": 70,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "redundant-cast",
      "description": "Redundant cast: `LmHeadModel` is the same type as `LmHeadModel`",
      "concise_description": "Redundant cast: `LmHeadModel` is the same type as `LmHeadModel`",
      "severity": "warn"
    },
    {
      "line": 1519,
      "column": 13,
      "stop_line": 1519,
      "stop_column": 42,
      "path": "lib/levanter/src/levanter/eval_harness.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `Mapping[Unknown, Unknown]`\n  Object of class `Mapping` has no attribute `__setitem__`",
      "concise_description": "Cannot set item in `Mapping[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 127,
      "column": 28,
      "stop_line": 127,
      "stop_column": 62,
      "path": "lib/levanter/src/levanter/grad_accum.py",
      "code": -2,
      "name": "invalid-param-spec",
      "description": "Expected *-unpacked Args.args and **-unpacked Args.kwargs",
      "concise_description": "Expected *-unpacked Args.args and **-unpacked Args.kwargs",
      "severity": "error"
    },
    {
      "line": 170,
      "column": 12,
      "stop_line": 170,
      "stop_column": 22,
      "path": "lib/levanter/src/levanter/grad_accum.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `_Wrapped[Args, R, [*args: Unknown, **kwargs: Unknown], Unknown]` is not assignable to declared return type `(ParamSpec(Args)) -> R`",
      "concise_description": "Returned type `_Wrapped[Args, R, [*args: Unknown, **kwargs: Unknown], Unknown]` is not assignable to declared return type `(ParamSpec(Args)) -> R`",
      "severity": "error"
    },
    {
      "line": 297,
      "column": 31,
      "stop_line": 297,
      "stop_column": 76,
      "path": "lib/levanter/src/levanter/inference/engine.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Array` is not assignable to variable `parent_local_id` with type `int`",
      "concise_description": "`Array` is not assignable to variable `parent_local_id` with type `int`",
      "severity": "error"
    },
    {
      "line": 299,
      "column": 30,
      "stop_line": 299,
      "stop_column": 74,
      "path": "lib/levanter/src/levanter/inference/engine.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Array` is not assignable to variable `child_local_id` with type `int | None`",
      "concise_description": "`Array` is not assignable to variable `child_local_id` with type `int | None`",
      "severity": "error"
    },
    {
      "line": 532,
      "column": 20,
      "stop_line": 532,
      "stop_column": 80,
      "path": "lib/levanter/src/levanter/inference/engine.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `object | Any` is not assignable to declared return type `GenState`",
      "concise_description": "Returned type `object | Any` is not assignable to declared return type `GenState`",
      "severity": "error"
    },
    {
      "line": 535,
      "column": 16,
      "stop_line": 535,
      "stop_column": 75,
      "path": "lib/levanter/src/levanter/inference/engine.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `object | Any` is not assignable to declared return type `GenState`",
      "concise_description": "Returned type `object | Any` is not assignable to declared return type `GenState`",
      "severity": "error"
    },
    {
      "line": 537,
      "column": 12,
      "stop_line": 537,
      "stop_column": 60,
      "path": "lib/levanter/src/levanter/inference/engine.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `int | Unknown` is not assignable to declared return type `GenState`",
      "concise_description": "Returned type `int | Unknown` is not assignable to declared return type `GenState`",
      "severity": "error"
    },
    {
      "line": 645,
      "column": 16,
      "stop_line": 645,
      "stop_column": 35,
      "path": "lib/levanter/src/levanter/inference/engine.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[DecodeState, object | Any]` is not assignable to declared return type `tuple[DecodeState, PageCache]`",
      "concise_description": "Returned type `tuple[DecodeState, object | Any]` is not assignable to declared return type `tuple[DecodeState, PageCache]`",
      "severity": "error"
    },
    {
      "line": 127,
      "column": 23,
      "stop_line": 127,
      "stop_column": 30,
      "path": "lib/levanter/src/levanter/inference/jit_scheduler.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Literal[2000000]` is not assignable to variable `slot_id` with type `Array | None`",
      "concise_description": "`Literal[2000000]` is not assignable to variable `slot_id` with type `Array | None`",
      "severity": "error"
    },
    {
      "line": 158,
      "column": 16,
      "stop_line": 158,
      "stop_column": 27,
      "path": "lib/levanter/src/levanter/inference/jit_scheduler.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[object | Any, object | Any]` is not assignable to declared return type `tuple[SequenceTable, int]`",
      "concise_description": "Returned type `tuple[object | Any, object | Any]` is not assignable to declared return type `tuple[SequenceTable, int]`",
      "severity": "error"
    },
    {
      "line": 236,
      "column": 26,
      "stop_line": 236,
      "stop_column": 30,
      "path": "lib/levanter/src/levanter/inference/openai.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to attribute `model` with type `LmHeadModel`",
      "concise_description": "`None` is not assignable to attribute `model` with type `LmHeadModel`",
      "severity": "error"
    },
    {
      "line": 237,
      "column": 27,
      "stop_line": 237,
      "stop_column": 31,
      "path": "lib/levanter/src/levanter/inference/openai.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to attribute `engine` with type `InferenceEngine`",
      "concise_description": "`None` is not assignable to attribute `engine` with type `InferenceEngine`",
      "severity": "error"
    },
    {
      "line": 569,
      "column": 16,
      "stop_line": 569,
      "stop_column": 103,
      "path": "lib/levanter/src/levanter/inference/openai.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `BatchEncoding | list[int] | list[list[int]] | list[str] | str` is not assignable to declared return type `list[int]`",
      "concise_description": "Returned type `BatchEncoding | list[int] | list[list[int]] | list[str] | str` is not assignable to declared return type `list[int]`",
      "severity": "error"
    },
    {
      "line": 67,
      "column": 22,
      "stop_line": 67,
      "stop_column": 31,
      "path": "lib/levanter/src/levanter/inference/utils.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(object: Any, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = ..., copy: bool = True, order: str | None = ..., ndmin: int = ..., *, device: Sharding | Unknown | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(object: Any, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = ..., copy: bool = True, order: str | None = ..., ndmin: int = ..., *, device: Sharding | Unknown | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 48,
      "column": 16,
      "stop_line": 48,
      "stop_column": 70,
      "path": "lib/levanter/src/levanter/infra/ray_tpu.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str | None` is not assignable to declared return type `str`",
      "concise_description": "Returned type `str | None` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 618,
      "column": 51,
      "stop_line": 620,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/infra/ray_tpu.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`list[Unknown | None]` is not assignable to `list[ObjectRef[Unknown]]`",
      "concise_description": "`list[Unknown | None]` is not assignable to `list[ObjectRef[Unknown]]`",
      "severity": "error"
    },
    {
      "line": 765,
      "column": 21,
      "stop_line": 765,
      "stop_column": 55,
      "path": "lib/levanter/src/levanter/infra/ray_tpu.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`RemoteFunctionNoArgs[@_]` is not assignable to variable `remote_fn` with type `RemoteFunction`",
      "concise_description": "`RemoteFunctionNoArgs[@_]` is not assignable to variable `remote_fn` with type `RemoteFunction`",
      "severity": "error"
    },
    {
      "line": 1031,
      "column": 24,
      "stop_line": 1031,
      "stop_column": 38,
      "path": "lib/levanter/src/levanter/infra/ray_tpu.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `ray.exceptions` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `ray.exceptions` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 1031,
      "column": 63,
      "stop_line": 1031,
      "stop_column": 77,
      "path": "lib/levanter/src/levanter/infra/ray_tpu.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `ray.exceptions` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `ray.exceptions` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 385,
      "column": 26,
      "stop_line": 385,
      "stop_column": 62,
      "path": "lib/levanter/src/levanter/layers/attention.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Array` is not assignable to variable `scaling_factor` with type `float | None`",
      "concise_description": "`Array` is not assignable to variable `scaling_factor` with type `float | None`",
      "severity": "error"
    },
    {
      "line": 795,
      "column": 12,
      "stop_line": 795,
      "stop_column": 79,
      "path": "lib/levanter/src/levanter/layers/attention.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `NamedArray | bool | Unknown` is not assignable to declared return type `NamedArray`",
      "concise_description": "Returned type `NamedArray | bool | Unknown` is not assignable to declared return type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 2046,
      "column": 26,
      "stop_line": 2046,
      "stop_column": 30,
      "path": "lib/levanter/src/levanter/layers/attention.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to `Linear`",
      "concise_description": "`None` is not assignable to `Linear`",
      "severity": "error"
    },
    {
      "line": 2224,
      "column": 9,
      "stop_line": 2224,
      "stop_column": 13,
      "path": "lib/levanter/src/levanter/layers/attention.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `AttentionWithSink.init` overrides parent class `Attention` in an inconsistent manner\n  `AttentionWithSink.init` has type `(config: AttentionConfig, *, key: Unknown) -> AttentionWithSink`, which is not consistent with `(config: AttentionConfig, *, key: Unknown) -> Attention` in `Attention.init` (the type of read-write attributes cannot be changed)",
      "concise_description": "Class member `AttentionWithSink.init` overrides parent class `Attention` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 243,
      "column": 12,
      "stop_line": 243,
      "stop_column": 18,
      "path": "lib/levanter/src/levanter/layers/gated_deltanet.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `NamedArray | bool | Unknown` is not assignable to declared return type `NamedArray`",
      "concise_description": "Returned type `NamedArray | bool | Unknown` is not assignable to declared return type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 112,
      "column": 48,
      "stop_line": 112,
      "stop_column": 66,
      "path": "lib/levanter/src/levanter/lora.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 249,
      "column": 49,
      "stop_line": 249,
      "stop_column": 67,
      "path": "lib/levanter/src/levanter/lora.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 103,
      "column": 20,
      "stop_line": 103,
      "stop_column": 31,
      "path": "lib/levanter/src/levanter/main/inference_repl.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[Unknown, None]` is not assignable to declared return type `tuple[LmHeadModel, PreTrainedTokenizer | PreTrainedTokenizerFast]`",
      "concise_description": "Returned type `tuple[Unknown, None]` is not assignable to declared return type `tuple[LmHeadModel, PreTrainedTokenizer | PreTrainedTokenizerFast]`",
      "severity": "error"
    },
    {
      "line": 234,
      "column": 13,
      "stop_line": 234,
      "stop_column": 29,
      "path": "lib/levanter/src/levanter/main/inference_repl.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`PreTrainedTokenizer | PreTrainedTokenizerFast` is not assignable to `str | None`",
      "concise_description": "`PreTrainedTokenizer | PreTrainedTokenizerFast` is not assignable to `str | None`",
      "severity": "error"
    },
    {
      "line": 245,
      "column": 13,
      "stop_line": 245,
      "stop_column": 29,
      "path": "lib/levanter/src/levanter/main/inference_repl.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`PreTrainedTokenizer | PreTrainedTokenizerFast` is not assignable to `str | None`",
      "concise_description": "`PreTrainedTokenizer | PreTrainedTokenizerFast` is not assignable to `str | None`",
      "severity": "error"
    },
    {
      "line": 94,
      "column": 54,
      "stop_line": 94,
      "stop_column": 62,
      "path": "lib/levanter/src/levanter/main/train_asr.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "concise_description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "severity": "error"
    },
    {
      "line": 120,
      "column": 28,
      "stop_line": 120,
      "stop_column": 70,
      "path": "lib/levanter/src/levanter/main/viz_logprobs.py",
      "code": -2,
      "name": "redundant-cast",
      "description": "Redundant cast: `LmHeadModel` is the same type as `LmHeadModel`",
      "concise_description": "Redundant cast: `LmHeadModel` is the same type as `LmHeadModel`",
      "severity": "warn"
    },
    {
      "line": 76,
      "column": 81,
      "stop_line": 76,
      "stop_column": 87,
      "path": "lib/levanter/src/levanter/metrics.py",
      "code": -2,
      "name": "bad-return",
      "description": "Function declared to return `Metric`, but one or more paths are missing an explicit `return`",
      "concise_description": "Function declared to return `Metric`, but one or more paths are missing an explicit `return`",
      "severity": "error"
    },
    {
      "line": 103,
      "column": 54,
      "stop_line": 103,
      "stop_column": 62,
      "path": "lib/levanter/src/levanter/models/asr_model.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "concise_description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "severity": "error"
    },
    {
      "line": 98,
      "column": 26,
      "stop_line": 98,
      "stop_column": 48,
      "path": "lib/levanter/src/levanter/models/flash_attention.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Array` is not assignable to variable `scaling_factor` with type `float | None`",
      "concise_description": "`Array` is not assignable to variable `scaling_factor` with type `float | None`",
      "severity": "error"
    },
    {
      "line": 109,
      "column": 5,
      "stop_line": 109,
      "stop_column": 8,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `GemmaConfig.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `GemmaConfig.Pos` and `HFCompatConfig.Pos` must both be descriptors",
      "concise_description": "Class member `GemmaConfig.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 110,
      "column": 5,
      "stop_line": 110,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `GemmaConfig.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `GemmaConfig.KeyPos` and `HFCompatConfig.KeyPos` must both be descriptors",
      "concise_description": "Class member `GemmaConfig.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 111,
      "column": 5,
      "stop_line": 111,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `GemmaConfig.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `GemmaConfig.Embed` and `HFCompatConfig.Embed` must both be descriptors",
      "concise_description": "Class member `GemmaConfig.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 216,
      "column": 9,
      "stop_line": 216,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `GemmaConfig.model_type` overrides parent class `HFCompatConfig` in an inconsistent manner\n  Property getter for `GemmaConfig.model_type` has type `BoundMethod[GemmaConfig, (self: GemmaConfig) -> type[GemmaLMHeadModel]]`, which is not assignable to `BoundMethod[GemmaConfig, (cls: GemmaConfig) -> type[LmWithHfSerializationMixin[Unknown]]]`, the property getter for `HFCompatConfig.model_type`",
      "concise_description": "Class member `GemmaConfig.model_type` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 290,
      "column": 22,
      "stop_line": 290,
      "stop_column": 39,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+` is not supported between `float` and `None`\n  Argument `None` is not assignable to parameter `value` with type `float` in function `float.__add__`",
      "concise_description": "`+` is not supported between `float` and `None`",
      "severity": "error"
    },
    {
      "line": 364,
      "column": 13,
      "stop_line": 364,
      "stop_column": 75,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`NamedArray | None` is not assignable to variable `x` with type `NamedArray`",
      "concise_description": "`NamedArray | None` is not assignable to variable `x` with type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 475,
      "column": 9,
      "stop_line": 475,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gemma2Config.model_type` overrides parent class `GemmaConfig` in an inconsistent manner\n  Property getter for `Gemma2Config.model_type` has type `BoundMethod[Gemma2Config, (self: Gemma2Config) -> type[Gemma2LMHeadModel]]`, which is not assignable to `BoundMethod[Gemma2Config, (self: Gemma2Config) -> type[GemmaLMHeadModel]]`, the property getter for `GemmaConfig.model_type`",
      "concise_description": "Class member `Gemma2Config.model_type` overrides parent class `GemmaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 480,
      "column": 9,
      "stop_line": 480,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gemma2Config.hf_checkpoint_converter` overrides parent class `GemmaConfig` in an inconsistent manner\n  `Gemma2Config.hf_checkpoint_converter` has type `BoundMethod[Gemma2Config, (self: Gemma2Config, ref_checkpoint: str = 'google/gemma-2-2b') -> HFCheckpointConverter[Gemma2Config]]`, which is not assignable to `BoundMethod[Gemma2Config, (self: Gemma2Config, ref_checkpoint: str = 'google/gemma-2b') -> HFCheckpointConverter[GemmaConfig]]`, the type of `GemmaConfig.hf_checkpoint_converter`",
      "concise_description": "Class member `Gemma2Config.hf_checkpoint_converter` overrides parent class `GemmaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 701,
      "column": 13,
      "stop_line": 701,
      "stop_column": 75,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`NamedArray | None` is not assignable to variable `x` with type `NamedArray`",
      "concise_description": "`NamedArray | None` is not assignable to variable `x` with type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 811,
      "column": 9,
      "stop_line": 811,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gemma3Config.model_type` overrides parent class `Gemma2Config` in an inconsistent manner\n  Property getter for `Gemma3Config.model_type` has type `BoundMethod[Gemma3Config, (self: Gemma3Config) -> type[Gemma3LMHeadModel]]`, which is not assignable to `BoundMethod[Gemma3Config, (self: Gemma3Config) -> type[Gemma2LMHeadModel]]`, the property getter for `Gemma2Config.model_type`",
      "concise_description": "Class member `Gemma3Config.model_type` overrides parent class `Gemma2Config` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 815,
      "column": 9,
      "stop_line": 815,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/models/gemma.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gemma3Config.hf_checkpoint_converter` overrides parent class `Gemma2Config` in an inconsistent manner\n  `Gemma3Config.hf_checkpoint_converter` has type `BoundMethod[Gemma3Config, (self: Gemma3Config, ref_checkpoint: str = 'google/gemma-3-1b-pt') -> HFCheckpointConverter[Gemma3Config]]`, which is not assignable to `BoundMethod[Gemma3Config, (self: Gemma3Config, ref_checkpoint: str = 'google/gemma-2-2b') -> HFCheckpointConverter[Gemma2Config]]`, the type of `Gemma2Config.hf_checkpoint_converter`",
      "concise_description": "Class member `Gemma3Config.hf_checkpoint_converter` overrides parent class `Gemma2Config` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 66,
      "column": 5,
      "stop_line": 66,
      "stop_column": 8,
      "path": "lib/levanter/src/levanter/models/gpt2.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gpt2Config.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `Gpt2Config.Pos` and `HFCompatConfig.Pos` must both be descriptors",
      "concise_description": "Class member `Gpt2Config.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 67,
      "column": 5,
      "stop_line": 67,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/gpt2.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gpt2Config.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `Gpt2Config.KeyPos` and `HFCompatConfig.KeyPos` must both be descriptors",
      "concise_description": "Class member `Gpt2Config.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 68,
      "column": 5,
      "stop_line": 68,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/models/gpt2.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gpt2Config.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `Gpt2Config.Embed` and `HFCompatConfig.Embed` must both be descriptors",
      "concise_description": "Class member `Gpt2Config.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 52,
      "column": 5,
      "stop_line": 52,
      "stop_column": 8,
      "path": "lib/levanter/src/levanter/models/gpt2_hyena.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gpt2HyenaConfig.Pos` overrides parent class `LmConfig` in an inconsistent manner\n  `Gpt2HyenaConfig.Pos` and `LmConfig.Pos` must both be descriptors",
      "concise_description": "Class member `Gpt2HyenaConfig.Pos` overrides parent class `LmConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 53,
      "column": 5,
      "stop_line": 53,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/gpt2_hyena.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gpt2HyenaConfig.KeyPos` overrides parent class `LmConfig` in an inconsistent manner\n  `Gpt2HyenaConfig.KeyPos` and `LmConfig.KeyPos` must both be descriptors",
      "concise_description": "Class member `Gpt2HyenaConfig.KeyPos` overrides parent class `LmConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 54,
      "column": 5,
      "stop_line": 54,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/models/gpt2_hyena.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Gpt2HyenaConfig.Embed` overrides parent class `LmConfig` in an inconsistent manner\n  `Gpt2HyenaConfig.Embed` and `LmConfig.Embed` must both be descriptors",
      "concise_description": "Class member `Gpt2HyenaConfig.Embed` overrides parent class `LmConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 91,
      "column": 5,
      "stop_line": 91,
      "stop_column": 8,
      "path": "lib/levanter/src/levanter/models/llama.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `LlamaConfig.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `LlamaConfig.Pos` and `HFCompatConfig.Pos` must both be descriptors",
      "concise_description": "Class member `LlamaConfig.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 92,
      "column": 5,
      "stop_line": 92,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/llama.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `LlamaConfig.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `LlamaConfig.KeyPos` and `HFCompatConfig.KeyPos` must both be descriptors",
      "concise_description": "Class member `LlamaConfig.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 93,
      "column": 5,
      "stop_line": 93,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/models/llama.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `LlamaConfig.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `LlamaConfig.Embed` and `HFCompatConfig.Embed` must both be descriptors",
      "concise_description": "Class member `LlamaConfig.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 180,
      "column": 9,
      "stop_line": 180,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/llama.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `LlamaConfig.model_type` overrides parent class `HFCompatConfig` in an inconsistent manner\n  Property getter for `LlamaConfig.model_type` has type `BoundMethod[LlamaConfig, (self: LlamaConfig) -> type[LlamaLMHeadModel]]`, which is not assignable to `BoundMethod[LlamaConfig, (cls: LlamaConfig) -> type[LmWithHfSerializationMixin[Unknown]]]`, the property getter for `HFCompatConfig.model_type`",
      "concise_description": "Class member `LlamaConfig.model_type` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 206,
      "column": 9,
      "stop_line": 206,
      "stop_column": 31,
      "path": "lib/levanter/src/levanter/models/llama.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `LlamaConfig.total_trainable_params` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `LlamaConfig.total_trainable_params` has type `BoundMethod[LlamaConfig, (self: LlamaConfig, vocab_size: Unknown) -> Unknown]`, which is not assignable to `BoundMethod[LlamaConfig, (self: LlamaConfig) -> float | None]`, the type of `HFCompatConfig.total_trainable_params`",
      "concise_description": "Class member `LlamaConfig.total_trainable_params` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 407,
      "column": 13,
      "stop_line": 407,
      "stop_column": 75,
      "path": "lib/levanter/src/levanter/models/llama.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`NamedArray | None` is not assignable to variable `x` with type `NamedArray`",
      "concise_description": "`NamedArray | None` is not assignable to variable `x` with type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 490,
      "column": 16,
      "stop_line": 490,
      "stop_column": 43,
      "path": "lib/levanter/src/levanter/models/llama.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `Axis | Mapping[str, int] | Sequence[Axis]` is not assignable to declared return type `Axis`",
      "concise_description": "Returned type `Axis | Mapping[str, int] | Sequence[Axis]` is not assignable to declared return type `Axis`",
      "severity": "error"
    },
    {
      "line": 154,
      "column": 7,
      "stop_line": 154,
      "stop_column": 18,
      "path": "lib/levanter/src/levanter/models/lm_model.py",
      "code": -2,
      "name": "invalid-type-var",
      "description": "Expected a type variable, got `Unknown`",
      "concise_description": "Expected a type variable, got `Unknown`",
      "severity": "error"
    },
    {
      "line": 262,
      "column": 50,
      "stop_line": 262,
      "stop_column": 58,
      "path": "lib/levanter/src/levanter/models/lm_model.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "concise_description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "severity": "error"
    },
    {
      "line": 24,
      "column": 50,
      "stop_line": 24,
      "stop_column": 58,
      "path": "lib/levanter/src/levanter/models/loss.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "concise_description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "severity": "error"
    },
    {
      "line": 99,
      "column": 50,
      "stop_line": 99,
      "stop_column": 58,
      "path": "lib/levanter/src/levanter/models/loss.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "concise_description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "severity": "error"
    },
    {
      "line": 147,
      "column": 50,
      "stop_line": 147,
      "stop_column": 58,
      "path": "lib/levanter/src/levanter/models/loss.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "concise_description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "severity": "error"
    },
    {
      "line": 169,
      "column": 50,
      "stop_line": 169,
      "stop_column": 58,
      "path": "lib/levanter/src/levanter/models/loss.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "concise_description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "severity": "error"
    },
    {
      "line": 81,
      "column": 9,
      "stop_line": 81,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/models/mistral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MistralConfig.hf_checkpoint_converter` overrides parent class `LlamaConfig` in an inconsistent manner\n  `MistralConfig.hf_checkpoint_converter` has type `BoundMethod[MistralConfig, (self: MistralConfig, ref_checkpoint: str | None = None) -> HFCheckpointConverter[MistralConfig]]`, which is not assignable to `BoundMethod[MistralConfig, (self: MistralConfig, ref_checkpoint: str | None = None) -> HFCheckpointConverter[LlamaConfig]]`, the type of `LlamaConfig.hf_checkpoint_converter`",
      "concise_description": "Class member `MistralConfig.hf_checkpoint_converter` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 112,
      "column": 9,
      "stop_line": 112,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/models/mistral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MistralConfig.to_hf_config` overrides parent class `LlamaConfig` in an inconsistent manner\n  `MistralConfig.to_hf_config` has type `BoundMethod[lib.levanter.src.levanter.models.mistral.MistralConfig, (self: lib.levanter.src.levanter.models.mistral.MistralConfig, vocab_size: int, config_overrides: dict[Unknown, Unknown] | None = None) -> transformers.models.mistral.configuration_mistral.MistralConfig]`, which is not assignable to `BoundMethod[MistralConfig, (self: MistralConfig, vocab_size: int, config_overrides: dict[Unknown, Unknown] | None = None) -> LlamaConfig]`, the type of `LlamaConfig.to_hf_config`",
      "concise_description": "Class member `MistralConfig.to_hf_config` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 146,
      "column": 9,
      "stop_line": 146,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/mistral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MistralConfig.model_type` overrides parent class `LlamaConfig` in an inconsistent manner\n  Property getter for `MistralConfig.model_type` has type `BoundMethod[MistralConfig, (cls: MistralConfig) -> type[MistralLMHeadModel]]`, which is not assignable to `BoundMethod[MistralConfig, (self: MistralConfig) -> type[LlamaLMHeadModel]]`, the property getter for `LlamaConfig.model_type`",
      "concise_description": "Class member `MistralConfig.model_type` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 149,
      "column": 9,
      "stop_line": 149,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/models/mistral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MistralConfig.flops_per_token` overrides parent class `LlamaConfig` in an inconsistent manner\n  `MistralConfig.flops_per_token` has type `BoundMethod[MistralConfig, (self: MistralConfig, vocab_size: int) -> float | None]`, which is not assignable to `BoundMethod[MistralConfig, (self: MistralConfig, vocab_size: int) -> float]`, the type of `LlamaConfig.flops_per_token`",
      "concise_description": "Class member `MistralConfig.flops_per_token` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 88,
      "column": 5,
      "stop_line": 88,
      "stop_column": 27,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MixtralConfig.gradient_checkpointing` overrides parent class `MistralConfig` in an inconsistent manner\n  `MixtralConfig.gradient_checkpointing` has type `Literal['full', 'nested', 'offload', 'recompute', 'save_all'] | ScanCheckpointPolicy | bool`, which is not assignable to `bool`, the type of `MistralConfig.gradient_checkpointing`",
      "concise_description": "Class member `MixtralConfig.gradient_checkpointing` overrides parent class `MistralConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 118,
      "column": 9,
      "stop_line": 118,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MixtralConfig.hf_checkpoint_converter` overrides parent class `MistralConfig` in an inconsistent manner\n  `MixtralConfig.hf_checkpoint_converter` has type `BoundMethod[MixtralConfig, (self: MixtralConfig, ref_checkpoint: str | None = None) -> HFCheckpointConverter[MixtralConfig]]`, which is not assignable to `BoundMethod[MixtralConfig, (self: MixtralConfig, ref_checkpoint: str | None = None) -> HFCheckpointConverter[MistralConfig]]`, the type of `MistralConfig.hf_checkpoint_converter`",
      "concise_description": "Class member `MixtralConfig.hf_checkpoint_converter` overrides parent class `MistralConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 150,
      "column": 9,
      "stop_line": 150,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MixtralConfig.to_hf_config` overrides parent class `MistralConfig` in an inconsistent manner\n  `MixtralConfig.to_hf_config` has type `BoundMethod[lib.levanter.src.levanter.models.mixtral.MixtralConfig, (self: lib.levanter.src.levanter.models.mixtral.MixtralConfig, vocab_size: int, config_overrides: dict[Unknown, Unknown] | None = None) -> transformers.models.mixtral.configuration_mixtral.MixtralConfig]`, which is not assignable to `BoundMethod[MixtralConfig, (self: MixtralConfig, vocab_size: int, config_overrides: dict[Unknown, Unknown] | None = None) -> MistralConfig]`, the type of `MistralConfig.to_hf_config`",
      "concise_description": "Class member `MixtralConfig.to_hf_config` overrides parent class `MistralConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 186,
      "column": 9,
      "stop_line": 186,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MixtralConfig.model_type` overrides parent class `MistralConfig` in an inconsistent manner\n  Property getter for `MixtralConfig.model_type` has type `BoundMethod[MixtralConfig, (cls: MixtralConfig) -> type[MixtralLMHeadModel]]`, which is not assignable to `BoundMethod[MixtralConfig, (cls: MixtralConfig) -> type[MistralLMHeadModel]]`, the property getter for `MistralConfig.model_type`",
      "concise_description": "Class member `MixtralConfig.model_type` overrides parent class `MistralConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 189,
      "column": 9,
      "stop_line": 189,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MixtralConfig.mk_LayerNorm` overrides parent class `MistralConfig` in an inconsistent manner\n  `MixtralConfig.mk_LayerNorm` has type `BoundMethod[MixtralConfig, (self: MixtralConfig, axis: Axis) -> RmsNorm]`, which is not assignable to `BoundMethod[MixtralConfig, (self: MixtralConfig, axis: Axis | Mapping[str, int] | Sequence[Axis]) -> LayerNormBase]`, the type of `MistralConfig.mk_LayerNorm`",
      "concise_description": "Class member `MixtralConfig.mk_LayerNorm` overrides parent class `MistralConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 304,
      "column": 13,
      "stop_line": 304,
      "stop_column": 17,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `list[list[Array]]`\n  No matching overload found for function `list.__setitem__` called with arguments: (int, Array)\n  Possible overloads:\n  (key: SupportsIndex, value: list[Array], /) -> None [closest match]\n  (key: slice[Any, Any, Any], value: Iterable[list[Array]], /) -> None",
      "concise_description": "Cannot set item in `list[list[Array]]`",
      "severity": "error"
    },
    {
      "line": 468,
      "column": 16,
      "stop_line": 468,
      "stop_column": 81,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[NamedArray, dict[str, NamedArray]]` is not assignable to declared return type `NamedArray`",
      "concise_description": "Returned type `tuple[NamedArray, dict[str, NamedArray]]` is not assignable to declared return type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 514,
      "column": 16,
      "stop_line": 514,
      "stop_column": 30,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[NamedArray, NamedArray]` is not assignable to declared return type `NamedArray`",
      "concise_description": "Returned type `tuple[NamedArray, NamedArray]` is not assignable to declared return type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 565,
      "column": 16,
      "stop_line": 565,
      "stop_column": 25,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[NamedArray, Unknown]` is not assignable to declared return type `NamedArray`",
      "concise_description": "Returned type `tuple[NamedArray, Unknown]` is not assignable to declared return type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 649,
      "column": 16,
      "stop_line": 649,
      "stop_column": 27,
      "path": "lib/levanter/src/levanter/models/mixtral.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[NamedArray, Literal[0] | NamedArray]` is not assignable to declared return type `NamedArray`",
      "concise_description": "Returned type `tuple[NamedArray, Literal[0] | NamedArray]` is not assignable to declared return type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 89,
      "column": 5,
      "stop_line": 89,
      "stop_column": 8,
      "path": "lib/levanter/src/levanter/models/olmo.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Olmo2Config.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `Olmo2Config.Pos` and `HFCompatConfig.Pos` must both be descriptors",
      "concise_description": "Class member `Olmo2Config.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 90,
      "column": 5,
      "stop_line": 90,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/olmo.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Olmo2Config.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `Olmo2Config.KeyPos` and `HFCompatConfig.KeyPos` must both be descriptors",
      "concise_description": "Class member `Olmo2Config.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 91,
      "column": 5,
      "stop_line": 91,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/models/olmo.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Olmo2Config.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `Olmo2Config.Embed` and `HFCompatConfig.Embed` must both be descriptors",
      "concise_description": "Class member `Olmo2Config.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 171,
      "column": 9,
      "stop_line": 171,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/olmo.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Olmo2Config.model_type` overrides parent class `HFCompatConfig` in an inconsistent manner\n  Property getter for `Olmo2Config.model_type` has type `BoundMethod[Olmo2Config, (self: Olmo2Config) -> type[Olmo2LMHeadModel]]`, which is not assignable to `BoundMethod[Olmo2Config, (cls: Olmo2Config) -> type[LmWithHfSerializationMixin[Unknown]]]`, the property getter for `HFCompatConfig.model_type`",
      "concise_description": "Class member `Olmo2Config.model_type` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 177,
      "column": 9,
      "stop_line": 177,
      "stop_column": 31,
      "path": "lib/levanter/src/levanter/models/olmo.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Olmo2Config.total_trainable_params` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `Olmo2Config.total_trainable_params` has type `BoundMethod[Olmo2Config, (self: Olmo2Config, vocab_size: Unknown) -> Unknown]`, which is not assignable to `BoundMethod[Olmo2Config, (self: Olmo2Config) -> float | None]`, the type of `HFCompatConfig.total_trainable_params`",
      "concise_description": "Class member `Olmo2Config.total_trainable_params` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 49,
      "column": 9,
      "stop_line": 49,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `QwenConfig.hf_checkpoint_converter` overrides parent class `LlamaConfig` in an inconsistent manner\n  `QwenConfig.hf_checkpoint_converter` has type `BoundMethod[QwenConfig, (self: QwenConfig, ref_checkpoint: str | None = None) -> HFCheckpointConverter[QwenConfig]]`, which is not assignable to `BoundMethod[QwenConfig, (self: QwenConfig, ref_checkpoint: str | None = None) -> HFCheckpointConverter[LlamaConfig]]`, the type of `LlamaConfig.hf_checkpoint_converter`",
      "concise_description": "Class member `QwenConfig.hf_checkpoint_converter` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 82,
      "column": 9,
      "stop_line": 82,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `QwenConfig.to_hf_config` overrides parent class `LlamaConfig` in an inconsistent manner\n  `QwenConfig.to_hf_config` has type `BoundMethod[QwenConfig, (self: QwenConfig, vocab_size: int, config_overrides: dict[Unknown, Unknown] | None = None) -> Qwen2Config]`, which is not assignable to `BoundMethod[QwenConfig, (self: QwenConfig, vocab_size: int, config_overrides: dict[Unknown, Unknown] | None = None) -> LlamaConfig]`, the type of `LlamaConfig.to_hf_config`",
      "concise_description": "Class member `QwenConfig.to_hf_config` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 110,
      "column": 9,
      "stop_line": 110,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `QwenConfig.model_type` overrides parent class `LlamaConfig` in an inconsistent manner\n  Property getter for `QwenConfig.model_type` has type `BoundMethod[QwenConfig, (self: QwenConfig) -> type[QwenLMHeadModel]]`, which is not assignable to `BoundMethod[QwenConfig, (self: QwenConfig) -> type[LlamaLMHeadModel]]`, the property getter for `LlamaConfig.model_type`",
      "concise_description": "Class member `QwenConfig.model_type` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 173,
      "column": 92,
      "stop_line": 175,
      "stop_column": 39,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`>` is not supported between `Axis` and `int`\n  Argument `Axis` is not assignable to parameter `value` with type `int` in function `int.__lt__`",
      "concise_description": "`>` is not supported between `Axis` and `int`",
      "severity": "error"
    },
    {
      "line": 192,
      "column": 5,
      "stop_line": 192,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `QwenTransformer.config` overrides parent class `LlamaTransformer` in an inconsistent manner\n  `QwenTransformer.config` has type `QwenConfig`, which is not consistent with `LlamaConfig` in `LlamaTransformer.config` (the type of read-write attributes cannot be changed)",
      "concise_description": "Class member `QwenTransformer.config` overrides parent class `LlamaTransformer` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 193,
      "column": 5,
      "stop_line": 193,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `QwenTransformer.layers` overrides parent class `LlamaTransformer` in an inconsistent manner\n  `QwenTransformer.layers` has type `levanter.utils.types.BlockFoldable[QwenDecoderLayer] | haliax.nn.scan.BlockFoldable[QwenDecoderLayer]`, which is not consistent with `levanter.utils.types.BlockFoldable[LlamaDecoderLayer] | haliax.nn.scan.BlockFoldable[LlamaDecoderLayer]` in `LlamaTransformer.layers` (the type of read-write attributes cannot be changed)",
      "concise_description": "Class member `QwenTransformer.layers` overrides parent class `LlamaTransformer` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 197,
      "column": 9,
      "stop_line": 197,
      "stop_column": 13,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `QwenTransformer.init` overrides parent class `LlamaTransformer` in an inconsistent manner\n  `QwenTransformer.init` has type `(config: QwenConfig, *, key: Unknown) -> QwenTransformer`, which is not consistent with `(config: LlamaConfig, *, key: Unknown) -> LlamaTransformer` in `LlamaTransformer.init` (the type of read-write attributes cannot be changed)",
      "concise_description": "Class member `QwenTransformer.init` overrides parent class `LlamaTransformer` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 218,
      "column": 13,
      "stop_line": 218,
      "stop_column": 75,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`NamedArray | None` is not assignable to variable `x` with type `NamedArray`",
      "concise_description": "`NamedArray | None` is not assignable to variable `x` with type `NamedArray`",
      "severity": "error"
    },
    {
      "line": 312,
      "column": 9,
      "stop_line": 312,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Qwen3Config.hf_checkpoint_converter` overrides parent class `LlamaConfig` in an inconsistent manner\n  `Qwen3Config.hf_checkpoint_converter` has type `BoundMethod[Qwen3Config, (self: Qwen3Config, ref_checkpoint: str | None = None) -> HFCheckpointConverter[Qwen3Config]]`, which is not assignable to `BoundMethod[Qwen3Config, (self: Qwen3Config, ref_checkpoint: str | None = None) -> HFCheckpointConverter[LlamaConfig]]`, the type of `LlamaConfig.hf_checkpoint_converter`",
      "concise_description": "Class member `Qwen3Config.hf_checkpoint_converter` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 323,
      "column": 9,
      "stop_line": 323,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/models/qwen.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `Qwen3Config.to_hf_config` overrides parent class `LlamaConfig` in an inconsistent manner\n  `Qwen3Config.to_hf_config` has type `BoundMethod[lib.levanter.src.levanter.models.qwen.Qwen3Config, (self: lib.levanter.src.levanter.models.qwen.Qwen3Config, vocab_size: int, config_overrides: dict[Unknown, Unknown] | None = None) -> transformers.models.qwen3.configuration_qwen3.Qwen3Config]`, which is not assignable to `BoundMethod[Qwen3Config, (self: Qwen3Config, vocab_size: int, config_overrides: dict[Unknown, Unknown] | None = None) -> LlamaConfig]`, the type of `LlamaConfig.to_hf_config`",
      "concise_description": "Class member `Qwen3Config.to_hf_config` overrides parent class `LlamaConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 64,
      "column": 9,
      "stop_line": 64,
      "stop_column": 19,
      "path": "lib/levanter/src/levanter/models/whisper.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `WhisperConfig.model_type` overrides parent class `HFCompatConfig` in an inconsistent manner\n  Property getter for `WhisperConfig.model_type` has type `BoundMethod[WhisperConfig, (self: WhisperConfig) -> type[WhisperModel]]`, which is not assignable to `BoundMethod[WhisperConfig, (cls: WhisperConfig) -> type[LmWithHfSerializationMixin[Unknown]]]`, the property getter for `HFCompatConfig.model_type`",
      "concise_description": "Class member `WhisperConfig.model_type` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 78,
      "column": 5,
      "stop_line": 78,
      "stop_column": 8,
      "path": "lib/levanter/src/levanter/models/whisper.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `WhisperConfig.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `WhisperConfig.Pos` and `HFCompatConfig.Pos` must both be descriptors",
      "concise_description": "Class member `WhisperConfig.Pos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 78,
      "column": 5,
      "stop_line": 78,
      "stop_column": 8,
      "path": "lib/levanter/src/levanter/models/whisper.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `WhisperConfig.Pos` overrides parent class `ASRConfig` in an inconsistent manner\n  `WhisperConfig.Pos` and `ASRConfig.Pos` must both be descriptors",
      "concise_description": "Class member `WhisperConfig.Pos` overrides parent class `ASRConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 79,
      "column": 5,
      "stop_line": 79,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/whisper.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `WhisperConfig.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `WhisperConfig.KeyPos` and `HFCompatConfig.KeyPos` must both be descriptors",
      "concise_description": "Class member `WhisperConfig.KeyPos` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 79,
      "column": 5,
      "stop_line": 79,
      "stop_column": 11,
      "path": "lib/levanter/src/levanter/models/whisper.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `WhisperConfig.KeyPos` overrides parent class `ASRConfig` in an inconsistent manner\n  `WhisperConfig.KeyPos` and `ASRConfig.KeyPos` must both be descriptors",
      "concise_description": "Class member `WhisperConfig.KeyPos` overrides parent class `ASRConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 82,
      "column": 5,
      "stop_line": 82,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/models/whisper.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `WhisperConfig.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner\n  `WhisperConfig.Embed` and `HFCompatConfig.Embed` must both be descriptors",
      "concise_description": "Class member `WhisperConfig.Embed` overrides parent class `HFCompatConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 82,
      "column": 5,
      "stop_line": 82,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/models/whisper.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `WhisperConfig.Embed` overrides parent class `ASRConfig` in an inconsistent manner\n  `WhisperConfig.Embed` and `ASRConfig.Embed` must both be descriptors",
      "concise_description": "Class member `WhisperConfig.Embed` overrides parent class `ASRConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 38,
      "column": 9,
      "stop_line": 38,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/adam_mini.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MiniConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `MiniConfig.build` has type `BoundMethod[MiniConfig, (self: MiniConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[MiniConfig, (self: MiniConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `MiniConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 111,
      "column": 5,
      "stop_line": 111,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/optim/adam_mini.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScaleByMiniState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner\n  `ScaleByMiniState.count` is read-only, but `NamedTupleFallback.count` is read-write",
      "concise_description": "Class member `ScaleByMiniState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 45,
      "column": 9,
      "stop_line": 45,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/adamh.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `AdamHConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `AdamHConfig.build` has type `BoundMethod[AdamHConfig, (self: AdamHConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[AdamHConfig, (self: AdamHConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `AdamHConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 101,
      "column": 5,
      "stop_line": 101,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/optim/adamh.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScaleByAdamHState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner\n  `ScaleByAdamHState.count` is read-only, but `NamedTupleFallback.count` is read-write",
      "concise_description": "Class member `ScaleByAdamHState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 33,
      "column": 9,
      "stop_line": 33,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/adopt.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `AdoptConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `AdoptConfig.build` has type `BoundMethod[AdoptConfig, (self: AdoptConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[AdoptConfig, (self: AdoptConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `AdoptConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 60,
      "column": 5,
      "stop_line": 60,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/optim/adopt.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScaleByAdoptState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner\n  `ScaleByAdoptState.count` is read-only, but `NamedTupleFallback.count` is read-write",
      "concise_description": "Class member `ScaleByAdoptState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 39,
      "column": 9,
      "stop_line": 39,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/cautious.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `CautiousConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `CautiousConfig.build` has type `BoundMethod[CautiousConfig, (self: CautiousConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[CautiousConfig, (self: CautiousConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `CautiousConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 72,
      "column": 5,
      "stop_line": 72,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/optim/cautious.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScaleByCautiousState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner\n  `ScaleByCautiousState.count` is read-only, but `NamedTupleFallback.count` is read-write",
      "concise_description": "Class member `ScaleByCautiousState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 194,
      "column": 17,
      "stop_line": 210,
      "stop_column": 30,
      "path": "lib/levanter/src/levanter/optim/config.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Literal[False] | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`Literal[False] | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 454,
      "column": 9,
      "stop_line": 454,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/config.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `AdamConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `AdamConfig.build` has type `BoundMethod[AdamConfig, (self: AdamConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[AdamConfig, (self: AdamConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `AdamConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 511,
      "column": 9,
      "stop_line": 511,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/config.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `LionConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `LionConfig.build` has type `BoundMethod[LionConfig, (self: LionConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[LionConfig, (self: LionConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `LionConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 113,
      "column": 9,
      "stop_line": 113,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/kron.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `KronConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `KronConfig.build` has type `BoundMethod[KronConfig[PartitionSpecTree], (self: KronConfig[PartitionSpecTree], num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[KronConfig[PartitionSpecTree], (self: KronConfig[PartitionSpecTree], num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `KronConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 198,
      "column": 61,
      "stop_line": 198,
      "stop_column": 91,
      "path": "lib/levanter/src/levanter/optim/kron.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(n: Unknown) -> Array` is not assignable to parameter `preconditioner_update_probability` with type `((int) -> float) | float`",
      "concise_description": "Default `(n: Unknown) -> Array` is not assignable to parameter `preconditioner_update_probability` with type `((int) -> float) | float`",
      "severity": "error"
    },
    {
      "line": 268,
      "column": 16,
      "stop_line": 268,
      "stop_column": 44,
      "path": "lib/levanter/src/levanter/optim/kron.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`SupportsDType | dtype[Any] | str | type[Any] | Any | None` is not assignable to variable `mu_dtype` with type `dtype[Any] | str | None`",
      "concise_description": "`SupportsDType | dtype[Any] | str | type[Any] | Any | None` is not assignable to variable `mu_dtype` with type `dtype[Any] | str | None`",
      "severity": "error"
    },
    {
      "line": 269,
      "column": 21,
      "stop_line": 269,
      "stop_column": 69,
      "path": "lib/levanter/src/levanter/optim/kron.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`SupportsDType | dtype[Any] | str | type[Any] | Any | None` is not assignable to variable `precond_dtype` with type `dtype[Any] | str | None`",
      "concise_description": "`SupportsDType | dtype[Any] | str | type[Any] | Any | None` is not assignable to variable `precond_dtype` with type `dtype[Any] | str | None`",
      "severity": "error"
    },
    {
      "line": 485,
      "column": 77,
      "stop_line": 485,
      "stop_column": 81,
      "path": "lib/levanter/src/levanter/optim/kron.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `None` is not assignable to parameter `params` with type `Array | Iterable[Unknown] | Mapping[Any, Unknown] | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]`",
      "concise_description": "Default `None` is not assignable to parameter `params` with type `Array | Iterable[Unknown] | Mapping[Any, Unknown] | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]`",
      "severity": "error"
    },
    {
      "line": 560,
      "column": 34,
      "stop_line": 560,
      "stop_column": 93,
      "path": "lib/levanter/src/levanter/optim/kron.py",
      "code": -2,
      "name": "redundant-cast",
      "description": "Redundant cast: `(int) -> float` is the same type as `(int) -> float`",
      "concise_description": "Redundant cast: `(int) -> float` is the same type as `(int) -> float`",
      "severity": "warn"
    },
    {
      "line": 927,
      "column": 61,
      "stop_line": 927,
      "stop_column": 91,
      "path": "lib/levanter/src/levanter/optim/kron.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(n: Unknown) -> Array` is not assignable to parameter `preconditioner_update_probability` with type `((int) -> float) | float`",
      "concise_description": "Default `(n: Unknown) -> Array` is not assignable to parameter `preconditioner_update_probability` with type `((int) -> float) | float`",
      "severity": "error"
    },
    {
      "line": 1169,
      "column": 21,
      "stop_line": 1169,
      "stop_column": 36,
      "path": "lib/levanter/src/levanter/optim/kron.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `list[None]`\n  No matching overload found for function `list.__setitem__` called with arguments: (int, PartitionSpec | Unknown)\n  Possible overloads:\n  (key: SupportsIndex, value: None, /) -> None [closest match]\n  (key: slice[Any, Any, Any], value: Iterable[None], /) -> None",
      "concise_description": "Cannot set item in `list[None]`",
      "severity": "error"
    },
    {
      "line": 32,
      "column": 9,
      "stop_line": 32,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/mars.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MarsConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `MarsConfig.build` has type `BoundMethod[MarsConfig, (self: MarsConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[MarsConfig, (self: MarsConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `MarsConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 59,
      "column": 5,
      "stop_line": 59,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/optim/mars.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScaleByMarsState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner\n  `ScaleByMarsState.count` is read-only, but `NamedTupleFallback.count` is read-write",
      "concise_description": "Class member `ScaleByMarsState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 42,
      "column": 9,
      "stop_line": 42,
      "stop_column": 15,
      "path": "lib/levanter/src/levanter/optim/model_averaging.py",
      "code": -2,
      "name": "bad-param-name-override",
      "description": "Class member `EmaModelAveraging.update` overrides parent class `ModelAveraging` in an inconsistent manner\n  Got parameter name `new_model`, expected `model`",
      "concise_description": "Class member `EmaModelAveraging.update` overrides parent class `ModelAveraging` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 73,
      "column": 9,
      "stop_line": 73,
      "stop_column": 15,
      "path": "lib/levanter/src/levanter/optim/model_averaging.py",
      "code": -2,
      "name": "bad-param-name-override",
      "description": "Class member `EmaDecaySqrtModelAveraging.update` overrides parent class `ModelAveraging` in an inconsistent manner\n  Got parameter name `new_model`, expected `model`",
      "concise_description": "Class member `EmaDecaySqrtModelAveraging.update` overrides parent class `ModelAveraging` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 49,
      "column": 9,
      "stop_line": 49,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/muon.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MuonConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `MuonConfig.build` has type `BoundMethod[MuonConfig, (self: MuonConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[MuonConfig, (self: MuonConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `MuonConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 50,
      "column": 9,
      "stop_line": 50,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/muonh.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MuonHConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `MuonHConfig.build` has type `BoundMethod[MuonHConfig, (self: MuonHConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[MuonHConfig, (self: MuonHConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `MuonHConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 29,
      "column": 9,
      "stop_line": 29,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/rmsprop.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `RMSPropMomentumConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `RMSPropMomentumConfig.build` has type `BoundMethod[RMSPropMomentumConfig, (self: RMSPropMomentumConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[RMSPropMomentumConfig, (self: RMSPropMomentumConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `RMSPropMomentumConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 60,
      "column": 5,
      "stop_line": 60,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/optim/rmsprop.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScaleByRMSPropMomState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner\n  `ScaleByRMSPropMomState.count` is read-only, but `NamedTupleFallback.count` is read-write",
      "concise_description": "Class member `ScaleByRMSPropMomState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 40,
      "column": 9,
      "stop_line": 40,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/scion.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScionConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `ScionConfig.build` has type `BoundMethod[ScionConfig, (self: ScionConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[ScionConfig, (self: ScionConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `ScionConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 50,
      "column": 9,
      "stop_line": 50,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/soap.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SoapConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner\n  `SoapConfig.build` has type `BoundMethod[SoapConfig, (self: SoapConfig, num_train_steps: Unknown) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[SoapConfig, (self: SoapConfig, num_train_steps: int) -> Never]`, the type of `OptimizerConfig.build`",
      "concise_description": "Class member `SoapConfig.build` overrides parent class `OptimizerConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 145,
      "column": 16,
      "stop_line": 145,
      "stop_column": 78,
      "path": "lib/levanter/src/levanter/optim/soap.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`SupportsDType | dtype[Any] | str | type[Any] | Any | None` is not assignable to variable `mu_dtype` with type `dtype[Any] | str | None`",
      "concise_description": "`SupportsDType | dtype[Any] | str | type[Any] | Any | None` is not assignable to variable `mu_dtype` with type `dtype[Any] | str | None`",
      "severity": "error"
    },
    {
      "line": 146,
      "column": 21,
      "stop_line": 146,
      "stop_column": 93,
      "path": "lib/levanter/src/levanter/optim/soap.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`SupportsDType | dtype[Any] | str | type[Any] | Any | None` is not assignable to variable `precond_dtype` with type `dtype[Any] | str | None`",
      "concise_description": "`SupportsDType | dtype[Any] | str | type[Any] | Any | None` is not assignable to variable `precond_dtype` with type `dtype[Any] | str | None`",
      "severity": "error"
    },
    {
      "line": 801,
      "column": 15,
      "stop_line": 801,
      "stop_column": 52,
      "path": "lib/levanter/src/levanter/optim/soap.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Array | Iterable[Unknown] | Mapping[Any, Unknown] | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]` is not assignable to variable `final_Q` with type `list[Array | None]`",
      "concise_description": "`Array | Iterable[Unknown] | Mapping[Any, Unknown] | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]` is not assignable to variable `final_Q` with type `list[Array | None]`",
      "severity": "error"
    },
    {
      "line": 802,
      "column": 18,
      "stop_line": 802,
      "stop_column": 53,
      "path": "lib/levanter/src/levanter/optim/soap.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Array | Iterable[Unknown] | Mapping[Any, Unknown] | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]` is not assignable to variable `exp_avg_sq` with type `Array`",
      "concise_description": "`Array | Iterable[Unknown] | Mapping[Any, Unknown] | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]` is not assignable to variable `exp_avg_sq` with type `Array`",
      "severity": "error"
    },
    {
      "line": 32,
      "column": 5,
      "stop_line": 32,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/optim/sophia.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScaleBySophiaState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner\n  `ScaleBySophiaState.count` is read-only, but `NamedTupleFallback.count` is read-write",
      "concise_description": "Class member `ScaleBySophiaState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 150,
      "column": 9,
      "stop_line": 150,
      "stop_column": 14,
      "path": "lib/levanter/src/levanter/optim/sophia.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `BaseSophiaConfig.build` overrides parent class `HessianOptConfig` in an inconsistent manner\n  `BaseSophiaConfig.build` has type `BoundMethod[BaseSophiaConfig, (self: BaseSophiaConfig, num_train_steps: int) -> GradientTransformationExtraArgs]`, which is not assignable to `BoundMethod[BaseSophiaConfig, (self: BaseSophiaConfig, num_train_steps: int) -> Never]`, the type of `HessianOptConfig.build`",
      "concise_description": "Class member `BaseSophiaConfig.build` overrides parent class `HessianOptConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 257,
      "column": 43,
      "stop_line": 257,
      "stop_column": 86,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "not-async",
      "description": "Type `None` is not awaitable",
      "concise_description": "Type `None` is not awaitable",
      "severity": "error"
    },
    {
      "line": 410,
      "column": 13,
      "stop_line": 410,
      "stop_column": 43,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "not-async",
      "description": "Type `None` is not awaitable",
      "concise_description": "Type `None` is not awaitable",
      "severity": "error"
    },
    {
      "line": 432,
      "column": 16,
      "stop_line": 432,
      "stop_column": 34,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `concurrent.futures` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `concurrent.futures` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 452,
      "column": 35,
      "stop_line": 452,
      "stop_column": 52,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`list[Any]` is not assignable to attribute `ledger` with type `CacheLedger | None`",
      "concise_description": "`list[Any]` is not assignable to attribute `ledger` with type `CacheLedger | None`",
      "severity": "error"
    },
    {
      "line": 567,
      "column": 14,
      "stop_line": 567,
      "stop_column": 23,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "invalid-type-var",
      "description": "Attribute `_exemplar` cannot depend on type variable `T`, which is not in the scope of class `SerialCacheWriter`",
      "concise_description": "Attribute `_exemplar` cannot depend on type variable `T`, which is not in the scope of class `SerialCacheWriter`",
      "severity": "error"
    },
    {
      "line": 650,
      "column": 18,
      "stop_line": 650,
      "stop_column": 24,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "invalid-type-var",
      "description": "Attribute `source` cannot depend on type variable `T`, which is not in the scope of class `_TreeStoreCacheBuilder`",
      "concise_description": "Attribute `source` cannot depend on type variable `T`, which is not in the scope of class `_TreeStoreCacheBuilder`",
      "severity": "error"
    },
    {
      "line": 691,
      "column": 19,
      "stop_line": 691,
      "stop_column": 53,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "bad-raise",
      "description": "Expression `self._finished_promise.exception()` has type `BaseException | None`, expected `BaseException`",
      "concise_description": "Expression `self._finished_promise.exception()` has type `BaseException | None`, expected `BaseException`",
      "severity": "error"
    },
    {
      "line": 740,
      "column": 16,
      "stop_line": 740,
      "stop_column": 34,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `concurrent.futures` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `concurrent.futures` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 744,
      "column": 9,
      "stop_line": 744,
      "stop_column": 22,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `_TreeStoreCacheBuilder._child_failed` overrides parent class `SnitchRecipient` in an inconsistent manner\n  `_TreeStoreCacheBuilder._child_failed` has type `BoundMethod[_TreeStoreCacheBuilder, (self: _TreeStoreCacheBuilder, child: ActorHandle | str | None, exception: ExceptionInfo) -> None]`, which is not assignable to `BoundMethod[_TreeStoreCacheBuilder, (self: _TreeStoreCacheBuilder, child: ActorHandle | str | None, exception: ExceptionInfo) -> Never]`, the type of `SnitchRecipient._child_failed`",
      "concise_description": "Class member `_TreeStoreCacheBuilder._child_failed` overrides parent class `SnitchRecipient` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 773,
      "column": 30,
      "stop_line": 773,
      "stop_column": 34,
      "path": "lib/levanter/src/levanter/store/cache.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to attribute `_cache_writer` with type `ObjectRef[None]`",
      "concise_description": "`None` is not assignable to attribute `_cache_writer` with type `ObjectRef[None]`",
      "severity": "error"
    },
    {
      "line": 211,
      "column": 25,
      "stop_line": 211,
      "stop_column": 59,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 236,
      "column": 25,
      "stop_line": 236,
      "stop_column": 50,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 282,
      "column": 32,
      "stop_line": 282,
      "stop_column": 76,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 318,
      "column": 32,
      "stop_line": 318,
      "stop_column": 76,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 364,
      "column": 55,
      "stop_line": 364,
      "stop_column": 78,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 376,
      "column": 39,
      "stop_line": 376,
      "stop_column": 56,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 393,
      "column": 32,
      "stop_line": 393,
      "stop_column": 46,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 416,
      "column": 32,
      "stop_line": 416,
      "stop_column": 46,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 451,
      "column": 39,
      "stop_line": 451,
      "stop_column": 56,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 495,
      "column": 13,
      "stop_line": 495,
      "stop_column": 30,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `list[tuple[Unknown, Unknown]]`\n  No matching overload found for function `list.__setitem__` called with arguments: (int, list[int | Unknown])\n  Possible overloads:\n  (key: SupportsIndex, value: tuple[Unknown, Unknown], /) -> None [closest match]\n  (key: slice[Any, Any, Any], value: Iterable[tuple[Unknown, Unknown]], /) -> None",
      "concise_description": "Cannot set item in `list[tuple[Unknown, Unknown]]`",
      "severity": "error"
    },
    {
      "line": 519,
      "column": 13,
      "stop_line": 519,
      "stop_column": 30,
      "path": "lib/levanter/src/levanter/store/jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `list[tuple[Unknown, Unknown]]`\n  No matching overload found for function `list.__setitem__` called with arguments: (int, list[int | Unknown])\n  Possible overloads:\n  (key: SupportsIndex, value: tuple[Unknown, Unknown], /) -> None [closest match]\n  (key: slice[Any, Any, Any], value: Iterable[tuple[Unknown, Unknown]], /) -> None",
      "concise_description": "Cannot set item in `list[tuple[Unknown, Unknown]]`",
      "severity": "error"
    },
    {
      "line": 200,
      "column": 26,
      "stop_line": 200,
      "stop_column": 29,
      "path": "lib/levanter/src/levanter/store/tree_store.py",
      "code": -2,
      "name": "bad-match",
      "description": "Cannot match positional sub-patterns in `Any`\n  Expected concrete tuple for `__match_args__`, got `Unknown`",
      "concise_description": "Cannot match positional sub-patterns in `Any`",
      "severity": "error"
    },
    {
      "line": 202,
      "column": 29,
      "stop_line": 202,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/store/tree_store.py",
      "code": -2,
      "name": "bad-match",
      "description": "Cannot match positional sub-patterns in `Any`\n  Expected concrete tuple for `__match_args__`, got `Unknown`",
      "concise_description": "Cannot match positional sub-patterns in `Any`",
      "severity": "error"
    },
    {
      "line": 204,
      "column": 30,
      "stop_line": 204,
      "stop_column": 31,
      "path": "lib/levanter/src/levanter/store/tree_store.py",
      "code": -2,
      "name": "bad-match",
      "description": "Cannot match positional sub-patterns in `Any`\n  Expected concrete tuple for `__match_args__`, got `Unknown`",
      "concise_description": "Cannot match positional sub-patterns in `Any`",
      "severity": "error"
    },
    {
      "line": 206,
      "column": 36,
      "stop_line": 206,
      "stop_column": 37,
      "path": "lib/levanter/src/levanter/store/tree_store.py",
      "code": -2,
      "name": "bad-match",
      "description": "Cannot match positional sub-patterns in `Any`\n  Expected concrete tuple for `__match_args__`, got `Unknown`",
      "concise_description": "Cannot match positional sub-patterns in `Any`",
      "severity": "error"
    },
    {
      "line": 760,
      "column": 21,
      "stop_line": 760,
      "stop_column": 34,
      "path": "lib/levanter/src/levanter/trainer.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `levanter.tracker.wandb` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `levanter.tracker.wandb` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 764,
      "column": 80,
      "stop_line": 764,
      "stop_column": 93,
      "path": "lib/levanter/src/levanter/trainer.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `levanter.tracker.wandb` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `levanter.tracker.wandb` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 1077,
      "column": 27,
      "stop_line": 1077,
      "stop_column": 44,
      "path": "lib/levanter/src/levanter/trainer.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `levanter.schedule` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `levanter.schedule` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 120,
      "column": 31,
      "stop_line": 120,
      "stop_column": 70,
      "path": "lib/levanter/src/levanter/trainer_state.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`ModelAveraging[M]` is not assignable to variable `model_averaging` with type `ModelAveragingConfig[M] | None`",
      "concise_description": "`ModelAveraging[M]` is not assignable to variable `model_averaging` with type `ModelAveragingConfig[M] | None`",
      "severity": "error"
    },
    {
      "line": 124,
      "column": 16,
      "stop_line": 135,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/trainer_state.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `TrainerState[M | Unknown]` is not assignable to declared return type `TrainerState[M]`",
      "concise_description": "Returned type `TrainerState[M | Unknown]` is not assignable to declared return type `TrainerState[M]`",
      "severity": "error"
    },
    {
      "line": 130,
      "column": 13,
      "stop_line": 130,
      "stop_column": 38,
      "path": "lib/levanter/src/levanter/trainer_state.py",
      "code": -2,
      "name": "bad-keyword-argument",
      "description": "Multiple values for argument `is_trainable` in function `TrainerState.__init__`",
      "concise_description": "Multiple values for argument `is_trainable` in function `TrainerState.__init__`",
      "severity": "error"
    },
    {
      "line": 131,
      "column": 13,
      "stop_line": 131,
      "stop_column": 18,
      "path": "lib/levanter/src/levanter/trainer_state.py",
      "code": -2,
      "name": "bad-keyword-argument",
      "description": "Multiple values for argument `mp` in function `TrainerState.__init__`",
      "concise_description": "Multiple values for argument `mp` in function `TrainerState.__init__`",
      "severity": "error"
    },
    {
      "line": 132,
      "column": 13,
      "stop_line": 132,
      "stop_column": 44,
      "path": "lib/levanter/src/levanter/trainer_state.py",
      "code": -2,
      "name": "bad-keyword-argument",
      "description": "Multiple values for argument `model_averaging` in function `TrainerState.__init__`",
      "concise_description": "Multiple values for argument `model_averaging` in function `TrainerState.__init__`",
      "severity": "error"
    },
    {
      "line": 143,
      "column": 14,
      "stop_line": 143,
      "stop_column": 21,
      "path": "lib/levanter/src/levanter/trainer_state.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 161,
      "column": 16,
      "stop_line": 166,
      "stop_column": 10,
      "path": "lib/levanter/src/levanter/trainer_state.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[TrainerState[Unknown], Unknown]` is not assignable to declared return type `tuple[S, M]`",
      "concise_description": "Returned type `tuple[TrainerState[Unknown], Unknown]` is not assignable to declared return type `tuple[S, M]`",
      "severity": "error"
    },
    {
      "line": 34,
      "column": 31,
      "stop_line": 34,
      "stop_column": 59,
      "path": "lib/levanter/src/levanter/utils/hf_utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`-` is not supported between `None` and `Literal[4]`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__rsub__`",
      "concise_description": "`-` is not supported between `None` and `Literal[4]`",
      "severity": "error"
    },
    {
      "line": 71,
      "column": 12,
      "stop_line": 71,
      "stop_column": 61,
      "path": "lib/levanter/src/levanter/utils/jax_utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 117,
      "column": 12,
      "stop_line": 117,
      "stop_column": 15,
      "path": "lib/levanter/src/levanter/utils/jax_utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `X | Any` is not assignable to declared return type `X`",
      "concise_description": "Returned type `X | Any` is not assignable to declared return type `X`",
      "severity": "error"
    },
    {
      "line": 301,
      "column": 9,
      "stop_line": 305,
      "stop_column": 65,
      "path": "lib/levanter/src/levanter/utils/jax_utils.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`tuple[int] | tuple[Unknown, Any]` is not assignable to `tuple[int]` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`tuple[int] | tuple[Unknown, Any]` is not assignable to `tuple[int]` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 325,
      "column": 9,
      "stop_line": 325,
      "stop_column": 36,
      "path": "lib/levanter/src/levanter/utils/jax_utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `list[None]`\n  No matching overload found for function `list.__setitem__` called with arguments: (int, str)\n  Possible overloads:\n  (key: SupportsIndex, value: None, /) -> None [closest match]\n  (key: slice[Any, Any, Any], value: Iterable[None], /) -> None",
      "concise_description": "Cannot set item in `list[None]`",
      "severity": "error"
    },
    {
      "line": 480,
      "column": 39,
      "stop_line": 480,
      "stop_column": 67,
      "path": "lib/levanter/src/levanter/utils/jax_utils.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Mesh | None` is not assignable to `Mesh`",
      "concise_description": "`Mesh | None` is not assignable to `Mesh`",
      "severity": "error"
    },
    {
      "line": 58,
      "column": 39,
      "stop_line": 58,
      "stop_column": 60,
      "path": "lib/levanter/src/levanter/utils/ray_utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, RuntimeEnv | dict[Unknown, Unknown] | int]`\n  Argument `str` is not assignable to parameter `value` with type `RuntimeEnv | dict[Unknown, Unknown] | int` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, RuntimeEnv | dict[Unknown, Unknown] | int]`",
      "severity": "error"
    },
    {
      "line": 92,
      "column": 31,
      "stop_line": 92,
      "stop_column": 32,
      "path": "lib/levanter/src/levanter/utils/thread_utils.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Exception` is not assignable to attribute `_exception` with type `None`",
      "concise_description": "`Exception` is not assignable to attribute `_exception` with type `None`",
      "severity": "error"
    },
    {
      "line": 54,
      "column": 54,
      "stop_line": 54,
      "stop_column": 62,
      "path": "lib/levanter/src/levanter/utils/types.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "concise_description": "Default `(array: NamedArray, axis: Axis | Mapping[str, int | None] | Sequence[Axis | str] | str | None = None, *, where: NamedArray | None = None, dtype: SupportsDType | dtype[Any] | str | type[Any] | None = None) -> NamedArray` is not assignable to parameter `reduction` with type `ReductionFunction | None`",
      "severity": "error"
    },
    {
      "line": 315,
      "column": 32,
      "stop_line": 315,
      "stop_column": 58,
      "path": "lib/levanter/tests/inference/test_inference_server.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 316,
      "column": 34,
      "stop_line": 316,
      "stop_column": 68,
      "path": "lib/levanter/tests/inference/test_inference_server.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 19,
      "column": 31,
      "stop_line": 19,
      "stop_column": 59,
      "path": "lib/levanter/tests/test_audio.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`*` is not supported between `Literal[2]` and `None`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__mul__`",
      "concise_description": "`*` is not supported between `Literal[2]` and `None`",
      "severity": "error"
    },
    {
      "line": 20,
      "column": 15,
      "stop_line": 20,
      "stop_column": 24,
      "path": "lib/levanter/tests/test_fsspec_safetensor.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `_InMemoryAsyncFS._cat_file` overrides parent class `AsyncFileSystem` in an inconsistent manner\n  `_InMemoryAsyncFS._cat_file` has type `BoundMethod[_InMemoryAsyncFS, (self: _InMemoryAsyncFS, path: str, start: int | None = None, end: int | None = None, **_: Unknown) -> Coroutine[Unknown, Unknown, bytes]]`, which is not assignable to `BoundMethod[_InMemoryAsyncFS, (self: _InMemoryAsyncFS, path: Unknown, start: Unknown | None = None, end: Unknown | None = None, **kwargs: Unknown) -> Coroutine[Unknown, Unknown, Never]]`, the type of `AsyncFileSystem._cat_file`",
      "concise_description": "Class member `_InMemoryAsyncFS._cat_file` overrides parent class `AsyncFileSystem` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 12,
      "column": 30,
      "stop_line": 12,
      "stop_column": 46,
      "path": "lib/levanter/tests/test_gdn_kernels.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `skip_if_no_torch` from `tests.test_utils`",
      "concise_description": "Could not import `skip_if_no_torch` from `tests.test_utils`",
      "severity": "error"
    },
    {
      "line": 17,
      "column": 30,
      "stop_line": 17,
      "stop_column": 46,
      "path": "lib/levanter/tests/test_gdn_layer.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `skip_if_no_torch` from `tests.test_utils`",
      "concise_description": "Could not import `skip_if_no_torch` from `tests.test_utils`",
      "severity": "error"
    },
    {
      "line": 352,
      "column": 28,
      "stop_line": 352,
      "stop_column": 33,
      "path": "lib/levanter/tests/test_gemma.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `ModelWithHfSerializationMixin[Unknown]`",
      "concise_description": "Expected a callable, got `ModelWithHfSerializationMixin[Unknown]`",
      "severity": "error"
    },
    {
      "line": 540,
      "column": 28,
      "stop_line": 540,
      "stop_column": 33,
      "path": "lib/levanter/tests/test_gemma.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `ModelWithHfSerializationMixin[Unknown]`",
      "concise_description": "Expected a callable, got `ModelWithHfSerializationMixin[Unknown]`",
      "severity": "error"
    },
    {
      "line": 29,
      "column": 30,
      "stop_line": 29,
      "stop_column": 43,
      "path": "lib/levanter/tests/test_hf_checkpoints.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `use_test_mesh` from `tests.test_utils`",
      "concise_description": "Could not import `use_test_mesh` from `tests.test_utils`",
      "severity": "error"
    },
    {
      "line": 94,
      "column": 60,
      "stop_line": 94,
      "stop_column": 67,
      "path": "lib/levanter/tests/test_hf_checkpoints.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 107,
      "column": 9,
      "stop_line": 107,
      "stop_column": 28,
      "path": "lib/levanter/tests/test_hf_checkpoints.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `BasicModelWrapper._state_dict_key_map` overrides parent class `ModuleWithStateDictSerialization` in an inconsistent manner\n  `BasicModelWrapper._state_dict_key_map` has type `BoundMethod[BasicModelWrapper, (self: BasicModelWrapper) -> dict[str, str]]`, which is not assignable to `BoundMethod[BasicModelWrapper, (self: BasicModelWrapper) -> dict[str, str | None]]`, the type of `ModuleWithStateDictSerialization._state_dict_key_map`",
      "concise_description": "Class member `BasicModelWrapper._state_dict_key_map` overrides parent class `ModuleWithStateDictSerialization` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 31,
      "column": 30,
      "stop_line": 31,
      "stop_column": 43,
      "path": "lib/levanter/tests/test_hf_gpt2_serialize.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `use_test_mesh` from `tests.test_utils`",
      "concise_description": "Could not import `use_test_mesh` from `tests.test_utils`",
      "severity": "error"
    },
    {
      "line": 288,
      "column": 34,
      "stop_line": 288,
      "stop_column": 54,
      "path": "lib/levanter/tests/test_jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 296,
      "column": 28,
      "stop_line": 296,
      "stop_column": 47,
      "path": "lib/levanter/tests/test_jagged_array.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 272,
      "column": 27,
      "stop_line": 272,
      "stop_column": 97,
      "path": "lib/levanter/tests/test_metrics.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`(metrics: Mapping[str, Any], step: int | None, commit: Unknown) -> None` is not assignable to attribute `log` with type `BoundMethod[Tracker, (self: Tracker, metrics: Mapping[str, Any], *, step: int | None, commit: bool | None = None) -> None]`",
      "concise_description": "`(metrics: Mapping[str, Any], step: int | None, commit: Unknown) -> None` is not assignable to attribute `log` with type `BoundMethod[Tracker, (self: Tracker, metrics: Mapping[str, Any], *, step: int | None, commit: bool | None = None) -> None]`",
      "severity": "error"
    },
    {
      "line": 306,
      "column": 27,
      "stop_line": 306,
      "stop_column": 97,
      "path": "lib/levanter/tests/test_metrics.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`(metrics: Mapping[str, Any], step: int | None, commit: Unknown) -> None` is not assignable to attribute `log` with type `BoundMethod[Tracker, (self: Tracker, metrics: Mapping[str, Any], *, step: int | None, commit: bool | None = None) -> None]`",
      "concise_description": "`(metrics: Mapping[str, Any], step: int | None, commit: Unknown) -> None` is not assignable to attribute `log` with type `BoundMethod[Tracker, (self: Tracker, metrics: Mapping[str, Any], *, step: int | None, commit: bool | None = None) -> None]`",
      "severity": "error"
    },
    {
      "line": 121,
      "column": 28,
      "stop_line": 121,
      "stop_column": 33,
      "path": "lib/levanter/tests/test_mistral.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `ModelWithHfSerializationMixin[Unknown]`",
      "concise_description": "Expected a callable, got `ModelWithHfSerializationMixin[Unknown]`",
      "severity": "error"
    },
    {
      "line": 292,
      "column": 28,
      "stop_line": 292,
      "stop_column": 33,
      "path": "lib/levanter/tests/test_mixtral.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `ModelWithHfSerializationMixin[Unknown]`",
      "concise_description": "Expected a callable, got `ModelWithHfSerializationMixin[Unknown]`",
      "severity": "error"
    },
    {
      "line": 28,
      "column": 9,
      "stop_line": 28,
      "stop_column": 24,
      "path": "lib/levanter/tests/test_new_cache.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `TestProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `TestProcessor.output_exemplar` has type `BoundMethod[TestProcessor, (self: TestProcessor) -> dict[str, ndarray[tuple[Any, ...], dtype[signedinteger[_64Bit]]]]]`, which is not assignable to `BoundMethod[TestProcessor, (self: TestProcessor) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `TestProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 59,
      "column": 47,
      "stop_line": 59,
      "stop_column": 51,
      "path": "lib/levanter/tests/test_new_cache.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[Unknown, Iterator[list[Unknown]]]`\n  Argument `None` is not assignable to parameter `value` with type `Iterator[list[Unknown]]` in function `dict.__setitem__`\n  Protocol `Iterator` requires attribute `__next__`",
      "concise_description": "Cannot set item in `dict[Unknown, Iterator[list[Unknown]]]`",
      "severity": "error"
    },
    {
      "line": 65,
      "column": 31,
      "stop_line": 65,
      "stop_column": 59,
      "path": "lib/levanter/tests/test_new_cache.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`*` is not supported between `Literal[2]` and `None`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__mul__`",
      "concise_description": "`*` is not supported between `Literal[2]` and `None`",
      "severity": "error"
    },
    {
      "line": 82,
      "column": 9,
      "stop_line": 82,
      "stop_column": 24,
      "path": "lib/levanter/tests/test_new_cache.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SimpleProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `SimpleProcessor.output_exemplar` has type `BoundMethod[SimpleProcessor, (self: SimpleProcessor) -> dict[str, ndarray[tuple[Any, ...], dtype[Any]]]]`, which is not assignable to `BoundMethod[SimpleProcessor, (self: SimpleProcessor) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `SimpleProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 18,
      "column": 30,
      "stop_line": 18,
      "stop_column": 46,
      "path": "lib/levanter/tests/test_ray_tpu.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `create_test_mesh` from `tests.test_utils`",
      "concise_description": "Could not import `create_test_mesh` from `tests.test_utils`",
      "severity": "error"
    },
    {
      "line": 18,
      "column": 60,
      "stop_line": 18,
      "stop_column": 73,
      "path": "lib/levanter/tests/test_ray_tpu.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `use_test_mesh` from `tests.test_utils`",
      "concise_description": "Could not import `use_test_mesh` from `tests.test_utils`",
      "severity": "error"
    },
    {
      "line": 203,
      "column": 16,
      "stop_line": 203,
      "stop_column": 22,
      "path": "lib/levanter/tests/test_ray_tpu.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `ndarray[tuple[Any, ...], dtype[Unknown]]` is not assignable to declared return type `None`",
      "concise_description": "Returned type `ndarray[tuple[Any, ...], dtype[Unknown]]` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 326,
      "column": 16,
      "stop_line": 326,
      "stop_column": 22,
      "path": "lib/levanter/tests/test_ray_tpu.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `ndarray[tuple[Any, ...], dtype[Unknown]]` is not assignable to declared return type `None`",
      "concise_description": "Returned type `ndarray[tuple[Any, ...], dtype[Unknown]]` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 291,
      "column": 28,
      "stop_line": 291,
      "stop_column": 64,
      "path": "lib/levanter/tests/test_skip_step.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Array | Iterable[Unknown] | Mapping[Any, Unknown] | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]` is not assignable to `SkipStepState`",
      "concise_description": "`Array | Iterable[Unknown] | Mapping[Any, Unknown] | numpy.bool[builtins.bool] | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int]` is not assignable to `SkipStepState`",
      "severity": "error"
    },
    {
      "line": 29,
      "column": 30,
      "stop_line": 29,
      "stop_column": 61,
      "path": "lib/levanter/tests/test_text.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `skip_if_hf_model_not_accessible` from `tests.test_utils`",
      "concise_description": "Could not import `skip_if_hf_model_not_accessible` from `tests.test_utils`",
      "severity": "error"
    },
    {
      "line": 377,
      "column": 28,
      "stop_line": 377,
      "stop_column": 46,
      "path": "lib/levanter/tests/test_text.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Array` is not assignable to `ndarray[tuple[Any, ...], dtype[Any]]`",
      "concise_description": "`Array` is not assignable to `ndarray[tuple[Any, ...], dtype[Any]]`",
      "severity": "error"
    },
    {
      "line": 21,
      "column": 9,
      "stop_line": 21,
      "stop_column": 24,
      "path": "lib/levanter/tests/test_tree_store.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SimpleProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `SimpleProcessor.output_exemplar` has type `BoundMethod[SimpleProcessor, (self: SimpleProcessor) -> dict[str, Sequence[int]]]`, which is not assignable to `BoundMethod[SimpleProcessor, (self: SimpleProcessor) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `SimpleProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 22,
      "column": 16,
      "stop_line": 22,
      "stop_column": 55,
      "path": "lib/levanter/tests/test_tree_store.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[str, ndarray[tuple[Any, ...], dtype[signedinteger[_64Bit]]]]` is not assignable to declared return type `dict[str, Sequence[int]]`",
      "concise_description": "Returned type `dict[str, ndarray[tuple[Any, ...], dtype[signedinteger[_64Bit]]]]` is not assignable to declared return type `dict[str, Sequence[int]]`",
      "severity": "error"
    },
    {
      "line": 57,
      "column": 15,
      "stop_line": 57,
      "stop_column": 33,
      "path": "lib/levanter/tests/test_utils.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 92,
      "column": 45,
      "stop_line": 92,
      "stop_column": 63,
      "path": "lib/levanter/tests/test_utils.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 206,
      "column": 9,
      "stop_line": 206,
      "stop_column": 24,
      "path": "lib/levanter/tests/test_utils.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `IdentityProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner\n  Property getter for `IdentityProcessor.output_exemplar` has type `BoundMethod[IdentityProcessor, (self: IdentityProcessor) -> BatchEncoding]`, which is not assignable to `BoundMethod[IdentityProcessor, (self: IdentityProcessor) -> Never]`, the property getter for `BatchProcessor.output_exemplar`",
      "concise_description": "Class member `IdentityProcessor.output_exemplar` overrides parent class `BatchProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 226,
      "column": 9,
      "stop_line": 226,
      "stop_column": 26,
      "path": "lib/levanter/tests/test_utils.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ShardsDataSource.open_shard_at_row` overrides parent class `ShardedDataSource` in an inconsistent manner\n  `ShardsDataSource.open_shard_at_row` has type `BoundMethod[ShardsDataSource[T], (self: ShardsDataSource[T], shard_name: str, row: int) -> list[T]]`, which is not assignable to `BoundMethod[ShardsDataSource[T], (self: ShardsDataSource[T], shard_name: str, row: int) -> Iterator[T]]`, the type of `ShardedDataSource.open_shard_at_row`",
      "concise_description": "Class member `ShardsDataSource.open_shard_at_row` overrides parent class `ShardedDataSource` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 238,
      "column": 9,
      "stop_line": 238,
      "stop_column": 26,
      "path": "lib/levanter/tests/test_utils.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SingleShardDocumentSource.open_shard_at_row` overrides parent class `ShardedDataSource` in an inconsistent manner\n  `SingleShardDocumentSource.open_shard_at_row` has type `BoundMethod[SingleShardDocumentSource[T], (self: SingleShardDocumentSource[T], shard_name: str, row: int) -> list[T]]`, which is not assignable to `BoundMethod[SingleShardDocumentSource[T], (self: SingleShardDocumentSource[T], shard_name: str, row: int) -> Iterator[T]]`, the type of `ShardedDataSource.open_shard_at_row`",
      "concise_description": "Class member `SingleShardDocumentSource.open_shard_at_row` overrides parent class `ShardedDataSource` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 33,
      "column": 24,
      "stop_line": 33,
      "stop_column": 68,
      "path": "lib/levanter/tests/test_weight_decay_mask.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 35,
      "column": 18,
      "stop_line": 35,
      "stop_column": 56,
      "path": "lib/levanter/tests/test_weight_decay_mask.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 55,
      "column": 24,
      "stop_line": 55,
      "stop_column": 68,
      "path": "lib/levanter/tests/test_weight_decay_mask.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 74,
      "column": 20,
      "stop_line": 74,
      "stop_column": 60,
      "path": "lib/levanter/tests/test_weight_decay_mask.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 75,
      "column": 31,
      "stop_line": 75,
      "stop_column": 82,
      "path": "lib/levanter/tests/test_weight_decay_mask.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 122,
      "column": 33,
      "stop_line": 122,
      "stop_column": 116,
      "path": "lib/marin/src/marin/classifiers/bert/training.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Dataset | DatasetDict | IterableDataset | IterableDatasetDict` is not assignable to `DatasetDict`",
      "concise_description": "`Dataset | DatasetDict | IterableDataset | IterableDatasetDict` is not assignable to `DatasetDict`",
      "severity": "error"
    },
    {
      "line": 171,
      "column": 28,
      "stop_line": 171,
      "stop_column": 56,
      "path": "lib/marin/src/marin/classifiers/bert/training.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Dataset | DatasetDict` is not assignable to `DatasetDict`",
      "concise_description": "`Dataset | DatasetDict` is not assignable to `DatasetDict`",
      "severity": "error"
    },
    {
      "line": 69,
      "column": 26,
      "stop_line": 69,
      "stop_column": 48,
      "path": "lib/marin/src/marin/classifiers/bert/utils.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`list[str]` is not assignable to attribute `label_set` with type `set[str]`",
      "concise_description": "`list[str]` is not assignable to attribute `label_set` with type `set[str]`",
      "severity": "error"
    },
    {
      "line": 77,
      "column": 9,
      "stop_line": 77,
      "stop_column": 20,
      "path": "lib/marin/src/marin/classifiers/bert/utils.py",
      "code": -2,
      "name": "bad-param-name-override",
      "description": "Class member `BertDataset.__getitem__` overrides parent class `Dataset` in an inconsistent manner\n  Got parameter name `idx`, expected `index`",
      "concise_description": "Class member `BertDataset.__getitem__` overrides parent class `Dataset` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 37,
      "column": 16,
      "stop_line": 37,
      "stop_column": 33,
      "path": "lib/marin/src/marin/classifiers/hf/monkey_patch_flash_attn.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `ModernBertUnpaddedRotaryEmbedding`",
      "concise_description": "Expected a callable, got `ModernBertUnpaddedRotaryEmbedding`",
      "severity": "error"
    },
    {
      "line": 85,
      "column": 12,
      "stop_line": 85,
      "stop_column": 46,
      "path": "lib/marin/src/marin/classifiers/hf/monkey_patch_flash_attn.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[Unknown, *tuple[Unknown, ...]]` is not assignable to declared return type `Tensor`",
      "concise_description": "Returned type `tuple[Unknown, *tuple[Unknown, ...]]` is not assignable to declared return type `Tensor`",
      "severity": "error"
    },
    {
      "line": 43,
      "column": 5,
      "stop_line": 43,
      "stop_column": 15,
      "path": "lib/marin/src/marin/classifiers/hf/train_classifier.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ScriptArguments.output_dir` overrides parent class `TrainingArguments` in an inconsistent manner\n  `ScriptArguments.output_dir` has type `str`, which is not consistent with `str | None` in `TrainingArguments.output_dir` (the type of read-write attributes cannot be changed)",
      "concise_description": "Class member `ScriptArguments.output_dir` overrides parent class `TrainingArguments` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 171,
      "column": 16,
      "stop_line": 179,
      "stop_column": 10,
      "path": "lib/marin/src/marin/classifiers/utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `bool | Unknown` is not assignable to declared return type `None`",
      "concise_description": "Returned type `bool | Unknown` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 468,
      "column": 12,
      "stop_line": 468,
      "stop_column": 32,
      "path": "lib/marin/src/marin/cluster/cleanup.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict_values[@_, @_]` is not assignable to declared return type `Sequence[dict[str, Any]]`",
      "concise_description": "Returned type `dict_values[@_, @_]` is not assignable to declared return type `Sequence[dict[str, Any]]`",
      "severity": "error"
    },
    {
      "line": 125,
      "column": 5,
      "stop_line": 158,
      "stop_column": 88,
      "path": "lib/marin/src/marin/cluster/dashboard_proxy.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Literal['active_nodes', 'nodes', 'pending_nodes', 'resources', 'usage'] | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`Literal['active_nodes', 'nodes', 'pending_nodes', 'resources', 'usage'] | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 417,
      "column": 23,
      "stop_line": 417,
      "stop_column": 84,
      "path": "lib/marin/src/marin/cluster/dashboard_proxy.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`BaseWSGIServer` is not assignable to attribute `server` with type `None`",
      "concise_description": "`BaseWSGIServer` is not assignable to attribute `server` with type `None`",
      "severity": "error"
    },
    {
      "line": 418,
      "column": 23,
      "stop_line": 418,
      "stop_column": 73,
      "path": "lib/marin/src/marin/cluster/dashboard_proxy.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`Thread` is not assignable to attribute `thread` with type `None`",
      "concise_description": "`Thread` is not assignable to attribute `thread` with type `None`",
      "severity": "error"
    },
    {
      "line": 211,
      "column": 13,
      "stop_line": 211,
      "stop_column": 50,
      "path": "lib/marin/src/marin/cluster/gcp.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+=` is not supported between `list[Unknown]` and `int`\n  Argument `int` is not assignable to parameter `value` with type `Iterable[Unknown]` in function `list.__iadd__`\n  Protocol `Iterable` requires attribute `__iter__`",
      "concise_description": "`+=` is not supported between `list[Unknown]` and `int`",
      "severity": "error"
    },
    {
      "line": 195,
      "column": 25,
      "stop_line": 195,
      "stop_column": 44,
      "path": "lib/marin/src/marin/core/runtime.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `ray.remote_function` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `ray.remote_function` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 198,
      "column": 64,
      "stop_line": 198,
      "stop_column": 80,
      "path": "lib/marin/src/marin/core/runtime.py",
      "code": -2,
      "name": "bad-keyword-argument",
      "description": "Multiple values for argument `fetch_local` in function `simple_backpressure`",
      "concise_description": "Multiple values for argument `fetch_local` in function `simple_backpressure`",
      "severity": "error"
    },
    {
      "line": 230,
      "column": 25,
      "stop_line": 230,
      "stop_column": 44,
      "path": "lib/marin/src/marin/core/runtime.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `ray.remote_function` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `ray.remote_function` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 97,
      "column": 26,
      "stop_line": 97,
      "stop_column": 34,
      "path": "lib/marin/src/marin/crawl/deduplicate_outlinks.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `bigquery` from `google.cloud`",
      "concise_description": "Could not import `bigquery` from `google.cloud`",
      "severity": "error"
    },
    {
      "line": 230,
      "column": 12,
      "stop_line": 230,
      "stop_column": 23,
      "path": "lib/marin/src/marin/crawl/deduplicate_outlinks_against_cc.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `list[tuple[int, ...]]` is not assignable to declared return type `list[tuple[int, int]]`",
      "concise_description": "Returned type `list[tuple[int, ...]]` is not assignable to declared return type `list[tuple[int, int]]`",
      "severity": "error"
    },
    {
      "line": 346,
      "column": 39,
      "stop_line": 346,
      "stop_column": 64,
      "path": "lib/marin/src/marin/crawl/fetch_links.py",
      "code": -2,
      "name": "bad-specialization",
      "description": "`Buffer` is not assignable to upper bound `bytes | str` of type variable `AnyStr`",
      "concise_description": "`Buffer` is not assignable to upper bound `bytes | str` of type variable `AnyStr`",
      "severity": "error"
    },
    {
      "line": 235,
      "column": 5,
      "stop_line": 238,
      "stop_column": 75,
      "path": "lib/marin/src/marin/crawl/fineweb_edu/get_urls_and_fineweb_scores_from_warcs.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`str` is not assignable to `LiteralString` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`str` is not assignable to `LiteralString` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 243,
      "column": 5,
      "stop_line": 247,
      "stop_column": 74,
      "path": "lib/marin/src/marin/crawl/fineweb_edu/get_urls_and_fineweb_scores_from_warcs.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`str` is not assignable to `LiteralString` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`str` is not assignable to `LiteralString` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 263,
      "column": 5,
      "stop_line": 263,
      "stop_column": 35,
      "path": "lib/marin/src/marin/crawl/fineweb_edu/get_urls_and_fineweb_scores_from_warcs.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `RemoteFunction2[None, str, str, int]`",
      "concise_description": "Expected a callable, got `RemoteFunction2[None, str, str, int]`",
      "severity": "error"
    },
    {
      "line": 246,
      "column": 40,
      "stop_line": 246,
      "stop_column": 45,
      "path": "lib/marin/src/marin/crawl/fineweb_edu/resample_fineweb_edu_urls_by_quality_score.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[Unknown, Literal[-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25] | bool]`\n  Argument `Literal[0] | int` is not assignable to parameter `value` with type `Literal[-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25] | bool` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[Unknown, Literal[-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25] | bool]`",
      "severity": "error"
    },
    {
      "line": 303,
      "column": 5,
      "stop_line": 303,
      "stop_column": 18,
      "path": "lib/marin/src/marin/crawl/fineweb_edu/resample_fineweb_edu_urls_by_quality_score.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `RemoteFunction4[None, str, str, str, str, str]`",
      "concise_description": "Expected a callable, got `RemoteFunction4[None, str, str, str, str, str]`",
      "severity": "error"
    },
    {
      "line": 215,
      "column": 43,
      "stop_line": 225,
      "stop_column": 18,
      "path": "lib/marin/src/marin/crawl/get_finemath_crawl_yield.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[Unknown, Mapping[str, str]]`\n  Argument `dict[str, dict[str, str] | str]` is not assignable to parameter `value` with type `Mapping[str, str]` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[Unknown, Mapping[str, str]]`",
      "severity": "error"
    },
    {
      "line": 198,
      "column": 43,
      "stop_line": 208,
      "stop_column": 18,
      "path": "lib/marin/src/marin/crawl/get_fineweb_edu_crawl_yield.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[Unknown, Mapping[str, str]]`\n  Argument `dict[str, dict[str, str] | str]` is not assignable to parameter `value` with type `Mapping[str, str]` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[Unknown, Mapping[str, str]]`",
      "severity": "error"
    },
    {
      "line": 389,
      "column": 35,
      "stop_line": 389,
      "stop_column": 45,
      "path": "lib/marin/src/marin/crawl/get_open_web_math_crawl_yield.py",
      "code": -2,
      "name": "bad-specialization",
      "description": "`Buffer` is not assignable to upper bound `bytes | str` of type variable `AnyStr`",
      "concise_description": "`Buffer` is not assignable to upper bound `bytes | str` of type variable `AnyStr`",
      "severity": "error"
    },
    {
      "line": 200,
      "column": 5,
      "stop_line": 203,
      "stop_column": 70,
      "path": "lib/marin/src/marin/crawl/open_web_math/get_urls_and_openwebmath_scores_from_warcs.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`str` is not assignable to `LiteralString` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`str` is not assignable to `LiteralString` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 221,
      "column": 5,
      "stop_line": 221,
      "stop_column": 35,
      "path": "lib/marin/src/marin/crawl/open_web_math/get_urls_and_openwebmath_scores_from_warcs.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `RemoteFunction2[None, str, str, int]`",
      "concise_description": "Expected a callable, got `RemoteFunction2[None, str, str, int]`",
      "severity": "error"
    },
    {
      "line": 260,
      "column": 40,
      "stop_line": 260,
      "stop_column": 45,
      "path": "lib/marin/src/marin/crawl/open_web_math/resample_openwebmath_urls_by_quality_score.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[Unknown, Literal[-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25] | bool]`\n  Argument `Literal[0] | int` is not assignable to parameter `value` with type `Literal[-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25] | bool` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[Unknown, Literal[-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25] | bool]`",
      "severity": "error"
    },
    {
      "line": 317,
      "column": 5,
      "stop_line": 317,
      "stop_column": 18,
      "path": "lib/marin/src/marin/crawl/open_web_math/resample_openwebmath_urls_by_quality_score.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `RemoteFunction4[None, list[str], str, str, str, str]`",
      "concise_description": "Expected a callable, got `RemoteFunction4[None, list[str], str, str, str, str]`",
      "severity": "error"
    },
    {
      "line": 89,
      "column": 9,
      "stop_line": 89,
      "stop_column": 22,
      "path": "lib/marin/src/marin/datashop/dataset_processor.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MeduDatasetOutputProcessor.extract_score` overrides parent class `DatasetOutputProcessor` in an inconsistent manner\n  `MeduDatasetOutputProcessor.extract_score` has type `(text: str) -> int`, which is not consistent with `BoundMethod[MeduDatasetOutputProcessor, (text: str) -> int]` in `DatasetOutputProcessor.extract_score` (the type of read-write attributes cannot be changed)",
      "concise_description": "Class member `MeduDatasetOutputProcessor.extract_score` overrides parent class `DatasetOutputProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 109,
      "column": 9,
      "stop_line": 109,
      "stop_column": 22,
      "path": "lib/marin/src/marin/datashop/dataset_processor.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `FinalScoreZeroToFiveDatasetOutputProcessor.extract_score` overrides parent class `DatasetOutputProcessor` in an inconsistent manner\n  `FinalScoreZeroToFiveDatasetOutputProcessor.extract_score` has type `(text: str) -> int`, which is not consistent with `BoundMethod[FinalScoreZeroToFiveDatasetOutputProcessor, (text: str) -> int]` in `DatasetOutputProcessor.extract_score` (the type of read-write attributes cannot be changed)",
      "concise_description": "Class member `FinalScoreZeroToFiveDatasetOutputProcessor.extract_score` overrides parent class `DatasetOutputProcessor` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 194,
      "column": 16,
      "stop_line": 194,
      "stop_column": 53,
      "path": "lib/marin/src/marin/datashop/pipeline.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `list[str]` is not assignable to declared return type `str`",
      "concise_description": "Returned type `list[str]` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 197,
      "column": 54,
      "stop_line": 197,
      "stop_column": 57,
      "path": "lib/marin/src/marin/datashop/pipeline.py",
      "code": -2,
      "name": "bad-return",
      "description": "Function declared to return `str` but is missing an explicit `return`",
      "concise_description": "Function declared to return `str` but is missing an explicit `return`",
      "severity": "error"
    },
    {
      "line": 182,
      "column": 36,
      "stop_line": 182,
      "stop_column": 47,
      "path": "lib/marin/src/marin/domains/stackexchange/utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, int]`\n  Argument `str | None` is not assignable to parameter `key` with type `str` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, int]`",
      "severity": "error"
    },
    {
      "line": 183,
      "column": 30,
      "stop_line": 183,
      "stop_column": 41,
      "path": "lib/marin/src/marin/domains/stackexchange/utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, dict[str, Any]]`\n  Argument `str | None` is not assignable to parameter `key` with type `str` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, dict[str, Any]]`",
      "severity": "error"
    },
    {
      "line": 223,
      "column": 36,
      "stop_line": 223,
      "stop_column": 54,
      "path": "lib/marin/src/marin/domains/stackexchange/utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, int]`\n  Argument `str | None` is not assignable to parameter `key` with type `str` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, int]`",
      "severity": "error"
    },
    {
      "line": 232,
      "column": 38,
      "stop_line": 232,
      "stop_column": 56,
      "path": "lib/marin/src/marin/domains/stackexchange/utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot delete item in `dict[str, dict[str, Any]]`\n  Argument `str | None` is not assignable to parameter `key` with type `str` in function `dict.__delitem__`",
      "concise_description": "Cannot delete item in `dict[str, dict[str, Any]]`",
      "severity": "error"
    },
    {
      "line": 233,
      "column": 44,
      "stop_line": 233,
      "stop_column": 62,
      "path": "lib/marin/src/marin/domains/stackexchange/utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot delete item in `dict[str, int]`\n  Argument `str | None` is not assignable to parameter `key` with type `str` in function `dict.__delitem__`",
      "concise_description": "Cannot delete item in `dict[str, int]`",
      "severity": "error"
    },
    {
      "line": 36,
      "column": 22,
      "stop_line": 36,
      "stop_column": 26,
      "path": "lib/marin/src/marin/download/ar5iv/download.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to `int`",
      "concise_description": "`None` is not assignable to `int`",
      "severity": "error"
    },
    {
      "line": 55,
      "column": 28,
      "stop_line": 55,
      "stop_column": 44,
      "path": "lib/marin/src/marin/download/huggingface/download.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`OutputName` is not assignable to `str`",
      "concise_description": "`OutputName` is not assignable to `str`",
      "severity": "error"
    },
    {
      "line": 103,
      "column": 46,
      "stop_line": 103,
      "stop_column": 62,
      "path": "lib/marin/src/marin/download/uncheatable_eval/download.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`OutputName` is not assignable to `VersionedValue[str] | str`",
      "concise_description": "`OutputName` is not assignable to `VersionedValue[str] | str`",
      "severity": "error"
    },
    {
      "line": 54,
      "column": 16,
      "stop_line": 54,
      "stop_column": 27,
      "path": "lib/marin/src/marin/download/wikipedia/download.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str` is not assignable to declared return type `None`",
      "concise_description": "Returned type `str` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 69,
      "column": 16,
      "stop_line": 69,
      "stop_column": 27,
      "path": "lib/marin/src/marin/download/wikipedia/download.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str` is not assignable to declared return type `None`",
      "concise_description": "Returned type `str` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 105,
      "column": 16,
      "stop_line": 105,
      "stop_column": 23,
      "path": "lib/marin/src/marin/evaluation/evaluators/alpaca_evaluator.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[Unknown, Unknown]` is not assignable to declared return type `None`",
      "concise_description": "Returned type `dict[Unknown, Unknown]` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 119,
      "column": 9,
      "stop_line": 119,
      "stop_column": 17,
      "path": "lib/marin/src/marin/evaluation/evaluators/alpaca_evaluator.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `AlpacaEvaluator.evaluate` overrides parent class `VllmTpuEvaluator` in an inconsistent manner\n  `AlpacaEvaluator.evaluate` has type `BoundMethod[AlpacaEvaluator, (self: AlpacaEvaluator, model: ModelConfig, evals: list[str], output_path: str, max_eval_instances: int | None = None) -> None]`, which is not assignable to `BoundMethod[AlpacaEvaluator, (self: AlpacaEvaluator, model: ModelConfig, evals: list[EvalTaskConfig], output_path: str, max_eval_instances: int | None = None, wandb_tags: list[str] | None = None) -> None]`, the type of `VllmTpuEvaluator.evaluate`",
      "concise_description": "Class member `AlpacaEvaluator.evaluate` overrides parent class `VllmTpuEvaluator` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 115,
      "column": 9,
      "stop_line": 115,
      "stop_column": 17,
      "path": "lib/marin/src/marin/evaluation/evaluators/helm_evaluator.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `HELMEvaluator.evaluate` overrides parent class `VllmTpuEvaluator` in an inconsistent manner\n  `HELMEvaluator.evaluate` has type `BoundMethod[HELMEvaluator, (self: HELMEvaluator, model: ModelConfig, evals: list[EvalTaskConfig], output_path: str, max_eval_instances: int | None = None) -> None]`, which is not assignable to `BoundMethod[HELMEvaluator, (self: HELMEvaluator, model: ModelConfig, evals: list[EvalTaskConfig], output_path: str, max_eval_instances: int | None = None, wandb_tags: list[str] | None = None) -> None]`, the type of `VllmTpuEvaluator.evaluate`",
      "concise_description": "Class member `HELMEvaluator.evaluate` overrides parent class `VllmTpuEvaluator` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 134,
      "column": 9,
      "stop_line": 134,
      "stop_column": 17,
      "path": "lib/marin/src/marin/evaluation/evaluators/simple_evaluator.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `SimpleEvaluator.evaluate` overrides parent class `VllmTpuEvaluator` in an inconsistent manner\n  `SimpleEvaluator.evaluate` has type `BoundMethod[SimpleEvaluator, (self: SimpleEvaluator, model: ModelConfig, evals: list[str], output_path: str, max_eval_instances: int | None = None) -> None]`, which is not assignable to `BoundMethod[SimpleEvaluator, (self: SimpleEvaluator, model: ModelConfig, evals: list[EvalTaskConfig], output_path: str, max_eval_instances: int | None = None, wandb_tags: list[str] | None = None) -> None]`, the type of `VllmTpuEvaluator.evaluate`",
      "concise_description": "Class member `SimpleEvaluator.evaluate` overrides parent class `VllmTpuEvaluator` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 127,
      "column": 9,
      "stop_line": 127,
      "stop_column": 33,
      "path": "lib/marin/src/marin/evaluation/evaluators/vllm_tpu_evaluator.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `VllmTpuEvaluator.launch_evaluate_with_ray` overrides parent class `Evaluator` in an inconsistent manner\n  `VllmTpuEvaluator.launch_evaluate_with_ray` has type `BoundMethod[VllmTpuEvaluator, (self: VllmTpuEvaluator, model: ModelConfig, evals: list[EvalTaskConfig], output_path: str, max_eval_instances: int | None = None, resource_config: ResourceConfig | None = None) -> None]`, which is not assignable to `BoundMethod[VllmTpuEvaluator, (self: VllmTpuEvaluator, model: ModelConfig, evals: list[EvalTaskConfig], output_path: str, max_eval_instances: int | None = None, resource_config: ResourceConfig | None = None, wandb_tags: list[str] | None = None) -> None]`, the type of `Evaluator.launch_evaluate_with_ray`",
      "concise_description": "Class member `VllmTpuEvaluator.launch_evaluate_with_ray` overrides parent class `Evaluator` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 127,
      "column": 36,
      "stop_line": 127,
      "stop_column": 46,
      "path": "lib/marin/src/marin/evaluation/log_probs.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`str` is not assignable to attribute `hf_checkpoint` with type `RepoRef | None`",
      "concise_description": "`str` is not assignable to attribute `hf_checkpoint` with type `RepoRef | None`",
      "severity": "error"
    },
    {
      "line": 134,
      "column": 52,
      "stop_line": 134,
      "stop_column": 61,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "concise_description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "severity": "error"
    },
    {
      "line": 140,
      "column": 37,
      "stop_line": 140,
      "stop_column": 46,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "concise_description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "severity": "error"
    },
    {
      "line": 336,
      "column": 13,
      "stop_line": 336,
      "stop_column": 22,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "concise_description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "severity": "error"
    },
    {
      "line": 465,
      "column": 13,
      "stop_line": 465,
      "stop_column": 22,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "concise_description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "severity": "error"
    },
    {
      "line": 466,
      "column": 6,
      "stop_line": 466,
      "stop_column": 15,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "concise_description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "severity": "error"
    },
    {
      "line": 530,
      "column": 42,
      "stop_line": 530,
      "stop_column": 51,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "concise_description": "Expected a type form, got instance of `Overload[[_T](cls: type[_T], /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> type[_T], (cls: None = None, /, *, init: bool = True, repr: bool = True, eq: bool = True, order: bool = False, unsafe_hash: bool = False, frozen: bool = False, match_args: bool = True, kw_only: bool = False, slots: bool = False, weakref_slot: bool = False) -> [_T](type[_T]) -> type[_T]]`",
      "severity": "error"
    },
    {
      "line": 577,
      "column": 9,
      "stop_line": 581,
      "stop_column": 64,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`ExecutorStep[Unknown] | InputName | None` is not assignable to `ExecutorStep[Unknown] | InputName` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`ExecutorStep[Unknown] | InputName | None` is not assignable to `ExecutorStep[Unknown] | InputName` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 698,
      "column": 43,
      "stop_line": 698,
      "stop_column": 106,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`|` is not supported between `None` and `dict[str, str]`\n  No matching overload found for function `dict.__ror__` called with arguments: (None)\n  Possible overloads:\n  (value: dict[str, str], /) -> dict[str, str] [closest match]\n  (value: dict[_T1, _T2], /) -> dict[str | _T1, str | _T2]",
      "concise_description": "`|` is not supported between `None` and `dict[str, str]`",
      "severity": "error"
    },
    {
      "line": 946,
      "column": 25,
      "stop_line": 946,
      "stop_column": 39,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `ray.util.state` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `ray.util.state` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 949,
      "column": 12,
      "stop_line": 949,
      "stop_column": 26,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `ray.util.state` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `ray.util.state` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 949,
      "column": 12,
      "stop_line": 949,
      "stop_column": 36,
      "path": "lib/marin/src/marin/execution/executor.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `ray.util.state.exception` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `ray.util.state.exception` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 36,
      "column": 16,
      "stop_line": 36,
      "stop_column": 57,
      "path": "lib/marin/src/marin/execution/status_actor.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str | None` is not assignable to declared return type `str`",
      "concise_description": "Returned type `str | None` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 223,
      "column": 50,
      "stop_line": 223,
      "stop_column": 59,
      "path": "lib/marin/src/marin/generation/chunk_utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Function declared to return `list[str]` but is missing an explicit `return`",
      "concise_description": "Function declared to return `list[str]` but is missing an explicit `return`",
      "severity": "error"
    },
    {
      "line": 135,
      "column": 55,
      "stop_line": 135,
      "stop_column": 65,
      "path": "lib/marin/src/marin/generation/inference.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, dict[str, str]]`\n  Argument `int` is not assignable to parameter `value` with type `dict[str, str]` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, dict[str, str]]`",
      "severity": "error"
    },
    {
      "line": 146,
      "column": 54,
      "stop_line": 148,
      "stop_column": 10,
      "path": "lib/marin/src/marin/generation/inference.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, OneToOneFilenameProvider]`\n  Argument `OverwriteOutputFiletypeFilenameProvider` is not assignable to parameter `value` with type `OneToOneFilenameProvider` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, OneToOneFilenameProvider]`",
      "severity": "error"
    },
    {
      "line": 155,
      "column": 59,
      "stop_line": 155,
      "stop_column": 71,
      "path": "lib/marin/src/marin/generation/inference.py",
      "code": -2,
      "name": "missing-module-attribute",
      "description": "Could not import `read_dataset` from `marin.processing.classification.inference`",
      "concise_description": "Could not import `read_dataset` from `marin.processing.classification.inference`",
      "severity": "error"
    },
    {
      "line": 66,
      "column": 71,
      "stop_line": 66,
      "stop_column": 84,
      "path": "lib/marin/src/marin/generation/llm_generation.py",
      "code": -2,
      "name": "invalid-argument",
      "description": "Expected a mapping, got dict[str, Any] | None",
      "concise_description": "Expected a mapping, got dict[str, Any] | None",
      "severity": "error"
    },
    {
      "line": 67,
      "column": 79,
      "stop_line": 67,
      "stop_column": 96,
      "path": "lib/marin/src/marin/generation/llm_generation.py",
      "code": -2,
      "name": "invalid-argument",
      "description": "Expected a mapping, got dict[str, Any] | None",
      "concise_description": "Expected a mapping, got dict[str, Any] | None",
      "severity": "error"
    },
    {
      "line": 236,
      "column": 9,
      "stop_line": 236,
      "stop_column": 19,
      "path": "lib/marin/src/marin/markdown/markdown.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `MyMarkdownConverter.convert_br` overrides parent class `MarkdownConverter` in an inconsistent manner\n  `MyMarkdownConverter.convert_br` has type `BoundMethod[MyMarkdownConverter, (self: MyMarkdownConverter, el: Unknown, text: Unknown, convert_as_inline: Unknown) -> Literal['  \\n', '<br>', '\\\\\\n']]`, which is not assignable to `BoundMethod[MyMarkdownConverter, (self: MyMarkdownConverter, el: Unknown, text: Unknown, convert_as_inline: Unknown) -> Literal['', '  \\n', '\\\\\\n']]`, the type of `MarkdownConverter.convert_br`",
      "concise_description": "Class member `MyMarkdownConverter.convert_br` overrides parent class `MarkdownConverter` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 49,
      "column": 46,
      "stop_line": 49,
      "stop_column": 57,
      "path": "lib/marin/src/marin/post_training/environments/load_environments.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, type[AquaRatEnv] | type[MathEnv] | type[NuminaMathEnv] | type[ORZEnv] | type[OlymMathEnv] | type[OlympiadBenchEnv] | type[OpenMathReasoningEnv] | type[SVAMPEnv]]`\n  Argument `type[SWEBenchEnv]` is not assignable to parameter `value` with type `type[AquaRatEnv] | type[MathEnv] | type[NuminaMathEnv] | type[ORZEnv] | type[OlymMathEnv] | type[OlympiadBenchEnv] | type[OpenMathReasoningEnv] | type[SVAMPEnv]` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, type[AquaRatEnv] | type[MathEnv] | type[NuminaMathEnv] | type[ORZEnv] | type[OlymMathEnv] | type[OlympiadBenchEnv] | type[OpenMathReasoningEnv] | type[SVAMPEnv]]`",
      "severity": "error"
    },
    {
      "line": 99,
      "column": 25,
      "stop_line": 99,
      "stop_column": 57,
      "path": "lib/marin/src/marin/post_training/environments/math_utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+` is not supported between `None` and `Literal[1]`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__radd__`",
      "concise_description": "`+` is not supported between `None` and `Literal[1]`",
      "severity": "error"
    },
    {
      "line": 560,
      "column": 13,
      "stop_line": 560,
      "stop_column": 21,
      "path": "lib/marin/src/marin/post_training/environments/math_utils.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`float` is not assignable to variable `x` with type `str`",
      "concise_description": "`float` is not assignable to variable `x` with type `str`",
      "severity": "error"
    },
    {
      "line": 596,
      "column": 16,
      "stop_line": 596,
      "stop_column": 20,
      "path": "lib/marin/src/marin/post_training/environments/math_utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `None` is not assignable to declared return type `str`",
      "concise_description": "Returned type `None` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 572,
      "column": 20,
      "stop_line": 577,
      "stop_column": 14,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[Array, dict[str, Array]]` is not assignable to declared return type `tuple[bool, dict[str, Array]]`",
      "concise_description": "Returned type `tuple[Array, dict[str, Array]]` is not assignable to declared return type `tuple[bool, dict[str, Array]]`",
      "severity": "error"
    },
    {
      "line": 589,
      "column": 20,
      "stop_line": 589,
      "stop_column": 58,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `Array` is not assignable to declared return type `bool`",
      "concise_description": "Returned type `Array` is not assignable to declared return type `bool`",
      "severity": "error"
    },
    {
      "line": 946,
      "column": 19,
      "stop_line": 946,
      "stop_column": 33,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "invalid-yield",
      "description": "Type of yielded value `tuple[str, str]` is not assignable to declared return type `tuple[ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]], str]`",
      "concise_description": "Type of yielded value `tuple[str, str]` is not assignable to declared return type `tuple[ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]], str]`",
      "severity": "error"
    },
    {
      "line": 973,
      "column": 12,
      "stop_line": 973,
      "stop_column": 31,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `list[list[Unknown]]` is not assignable to declared return type `list[dict[str, Any]]`",
      "concise_description": "Returned type `list[list[Unknown]]` is not assignable to declared return type `list[dict[str, Any]]`",
      "severity": "error"
    },
    {
      "line": 1021,
      "column": 16,
      "stop_line": 1028,
      "stop_column": 10,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `list[dict[str, Any]]` is not assignable to declared return type `list[list[dict[Unknown, Unknown]]]`",
      "concise_description": "Returned type `list[dict[str, Any]]` is not assignable to declared return type `list[list[dict[Unknown, Unknown]]]`",
      "severity": "error"
    },
    {
      "line": 1097,
      "column": 5,
      "stop_line": 1097,
      "stop_column": 13,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "annotation-mismatch",
      "description": "`sharding` cannot be annotated with `list[int]`, it is already defined with type `str`",
      "concise_description": "`sharding` cannot be annotated with `list[int]`, it is already defined with type `str`",
      "severity": "error"
    },
    {
      "line": 1102,
      "column": 5,
      "stop_line": 1102,
      "stop_column": 22,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "annotation-mismatch",
      "description": "`generation_config` cannot be annotated with `dict[str, Any]`, it is already defined with type `str`",
      "concise_description": "`generation_config` cannot be annotated with `dict[str, Any]`, it is already defined with type `str`",
      "severity": "error"
    },
    {
      "line": 1103,
      "column": 5,
      "stop_line": 1103,
      "stop_column": 26,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "annotation-mismatch",
      "description": "`model_config_override` cannot be annotated with `dict[str, Any]`, it is already defined with type `str`",
      "concise_description": "`model_config_override` cannot be annotated with `dict[str, Any]`, it is already defined with type `str`",
      "severity": "error"
    },
    {
      "line": 1104,
      "column": 5,
      "stop_line": 1104,
      "stop_column": 23,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "annotation-mismatch",
      "description": "`tokenizer_override` cannot be annotated with `dict[str, Any]`, it is already defined with type `str`",
      "concise_description": "`tokenizer_override` cannot be annotated with `dict[str, Any]`, it is already defined with type `str`",
      "severity": "error"
    },
    {
      "line": 1105,
      "column": 5,
      "stop_line": 1105,
      "stop_column": 37,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "annotation-mismatch",
      "description": "`jax_distributed_initalize_config` cannot be annotated with `dict[str, Any]`, it is already defined with type `str`",
      "concise_description": "`jax_distributed_initalize_config` cannot be annotated with `dict[str, Any]`, it is already defined with type `str`",
      "severity": "error"
    },
    {
      "line": 1242,
      "column": 29,
      "stop_line": 1242,
      "stop_column": 66,
      "path": "lib/marin/src/marin/post_training/flax/inference.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`GenerationConfig` is not assignable to variable `generation_config` with type `str`",
      "concise_description": "`GenerationConfig` is not assignable to variable `generation_config` with type `str`",
      "severity": "error"
    },
    {
      "line": 722,
      "column": 17,
      "stop_line": 722,
      "stop_column": 35,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`>` is not supported between `None` and `Literal[0]`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__lt__`",
      "concise_description": "`>` is not supported between `None` and `Literal[0]`",
      "severity": "error"
    },
    {
      "line": 953,
      "column": 31,
      "stop_line": 953,
      "stop_column": 35,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to `Module`",
      "concise_description": "`None` is not assignable to `Module`",
      "severity": "error"
    },
    {
      "line": 967,
      "column": 9,
      "stop_line": 967,
      "stop_column": 21,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `FlaxLLaMAPreTrainedModel.init_weights` overrides parent class `FlaxPreTrainedModel` in an inconsistent manner\n  `FlaxLLaMAPreTrainedModel.init_weights` has type `BoundMethod[FlaxLLaMAPreTrainedModel, (self: FlaxLLaMAPreTrainedModel, rng: Unknown, input_shape: tuple[Unknown, ...], params: FrozenDict[Unknown, Unknown] = ...) -> FrozenDict[Unknown, Unknown]]`, which is not assignable to `BoundMethod[FlaxLLaMAPreTrainedModel, (self: FlaxLLaMAPreTrainedModel, rng: Unknown, input_shape: tuple[Unknown, ...], params: FrozenDict[Unknown, Unknown] = ...) -> dict[Unknown, Unknown]]`, the type of `FlaxPreTrainedModel.init_weights`",
      "concise_description": "Class member `FlaxLLaMAPreTrainedModel.init_weights` overrides parent class `FlaxPreTrainedModel` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 967,
      "column": 33,
      "stop_line": 967,
      "stop_column": 51,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 967,
      "column": 94,
      "stop_line": 967,
      "stop_column": 98,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-function-definition",
      "description": "Default `None` is not assignable to parameter `params` with type `FrozenDict[Unknown, Unknown]`",
      "concise_description": "Default `None` is not assignable to parameter `params` with type `FrozenDict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 994,
      "column": 22,
      "stop_line": 994,
      "stop_column": 52,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`dict[Unknown, _EmptyNode] | dict[Unknown, Unknown]` is not assignable to variable `params` with type `FrozenDict[Unknown, Unknown]`",
      "concise_description": "`dict[Unknown, _EmptyNode] | dict[Unknown, Unknown]` is not assignable to variable `params` with type `FrozenDict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 1029,
      "column": 22,
      "stop_line": 1029,
      "stop_column": 40,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "concise_description": "Expected a type form, got instance of `(seed: Array | builtins.bool | numpy.bool[builtins.bool] | complex | float | int | ndarray[tuple[Any, ...], dtype[Any]] | number[Any, complex | float | int], *, impl: PRNGImpl | PRNGSpec | str | None = None) -> Array`",
      "severity": "error"
    },
    {
      "line": 1090,
      "column": 13,
      "stop_line": 1090,
      "stop_column": 37,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`FrozenDict[str, Mapping[str, Any]] | dict[str, Any] | Any` is not assignable to `dict[Unknown, Unknown] | None`",
      "concise_description": "`FrozenDict[str, Mapping[str, Any]] | dict[str, Any] | Any` is not assignable to `dict[Unknown, Unknown] | None`",
      "severity": "error"
    },
    {
      "line": 1094,
      "column": 13,
      "stop_line": 1094,
      "stop_column": 37,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`FrozenDict[str, Mapping[str, Any]] | dict[str, Any] | Any` is not assignable to `dict[Unknown, Unknown] | None`",
      "concise_description": "`FrozenDict[str, Mapping[str, Any]] | dict[str, Any] | Any` is not assignable to `dict[Unknown, Unknown] | None`",
      "severity": "error"
    },
    {
      "line": 1133,
      "column": 17,
      "stop_line": 1133,
      "stop_column": 54,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+=` is not supported between `None` and `tuple[Unknown]`\n  Cannot find `__iadd__` or `__add__` or `__radd__`",
      "concise_description": "`+=` is not supported between `None` and `tuple[Unknown]`",
      "severity": "error"
    },
    {
      "line": 1146,
      "column": 17,
      "stop_line": 1146,
      "stop_column": 54,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+=` is not supported between `None` and `tuple[Unknown]`\n  Cannot find `__iadd__` or `__add__` or `__radd__`",
      "concise_description": "`+=` is not supported between `None` and `tuple[Unknown]`",
      "severity": "error"
    },
    {
      "line": 1212,
      "column": 33,
      "stop_line": 1212,
      "stop_column": 62,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+` is not supported between `None` and `tuple[Array]`\n  Cannot find `__add__` or `__radd__`",
      "concise_description": "`+` is not supported between `None` and `tuple[Array]`",
      "severity": "error"
    },
    {
      "line": 1229,
      "column": 20,
      "stop_line": 1229,
      "stop_column": 35,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`type[FlaxLLaMAModule]` is not assignable to attribute `module_class` with type `Module`",
      "concise_description": "`type[FlaxLLaMAModule]` is not assignable to attribute `module_class` with type `Module`",
      "severity": "error"
    },
    {
      "line": 1302,
      "column": 20,
      "stop_line": 1302,
      "stop_column": 46,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`type[FlaxLLaMAForCausalLMModule]` is not assignable to attribute `module_class` with type `Module`",
      "concise_description": "`type[FlaxLLaMAForCausalLMModule]` is not assignable to attribute `module_class` with type `Module`",
      "severity": "error"
    },
    {
      "line": 1304,
      "column": 9,
      "stop_line": 1304,
      "stop_column": 38,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `FlaxLLaMAForCausalLM.prepare_inputs_for_generation` overrides parent class `FlaxLLaMAPreTrainedModel` in an inconsistent manner\n  `FlaxLLaMAForCausalLM.prepare_inputs_for_generation` has type `BoundMethod[FlaxLLaMAForCausalLM, (self: FlaxLLaMAForCausalLM, input_ids: Unknown, max_length: Unknown, attention_mask: Array | None = None, position_ids: Array | None = None, past_key_values: dict[str, Array] | None = None) -> dict[str, Array | dict[str, Array] | None]]`, which is not assignable to `BoundMethod[FlaxLLaMAForCausalLM, (self: FlaxLLaMAForCausalLM, *args: Unknown, **kwargs: Unknown) -> Never]`, the type of `FlaxLLaMAPreTrainedModel.prepare_inputs_for_generation`",
      "concise_description": "Class member `FlaxLLaMAForCausalLM.prepare_inputs_for_generation` overrides parent class `FlaxLLaMAPreTrainedModel` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 1317,
      "column": 31,
      "stop_line": 1317,
      "stop_column": 70,
      "path": "lib/marin/src/marin/post_training/flax/llama3.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`FrozenDict[Unknown, Unknown] | Unknown` is not assignable to variable `past_key_values` with type `dict[str, Array] | None`",
      "concise_description": "`FrozenDict[Unknown, Unknown] | Unknown` is not assignable to variable `past_key_values` with type `dict[str, Array] | None`",
      "severity": "error"
    },
    {
      "line": 90,
      "column": 30,
      "stop_line": 90,
      "stop_column": 59,
      "path": "lib/marin/src/marin/post_training/flax/optimizer.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Unary `-` is not supported on `numpy.bool[builtins.bool]`\n  Object of class `bool` has no attribute `__neg__`",
      "concise_description": "Unary `-` is not supported on `numpy.bool[builtins.bool]`",
      "severity": "error"
    },
    {
      "line": 111,
      "column": 5,
      "stop_line": 111,
      "stop_column": 10,
      "path": "lib/marin/src/marin/post_training/flax/optimizer.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `OptaxScheduledWeightDecayState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner\n  `OptaxScheduledWeightDecayState.count` is read-only, but `NamedTupleFallback.count` is read-write",
      "concise_description": "Class member `OptaxScheduledWeightDecayState.count` overrides parent class `NamedTupleFallback` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 234,
      "column": 24,
      "stop_line": 236,
      "stop_column": 14,
      "path": "lib/marin/src/marin/post_training/flax/train.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Unary `-` is not supported on `numpy.bool[builtins.bool]`\n  Object of class `bool` has no attribute `__neg__`",
      "concise_description": "Unary `-` is not supported on `numpy.bool[builtins.bool]`",
      "severity": "error"
    },
    {
      "line": 264,
      "column": 38,
      "stop_line": 264,
      "stop_column": 49,
      "path": "lib/marin/src/marin/post_training/flax/train.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Unary `-` is not supported on `numpy.bool[builtins.bool]`\n  Object of class `bool` has no attribute `__neg__`",
      "concise_description": "Unary `-` is not supported on `numpy.bool[builtins.bool]`",
      "severity": "error"
    },
    {
      "line": 264,
      "column": 75,
      "stop_line": 264,
      "stop_column": 86,
      "path": "lib/marin/src/marin/post_training/flax/train.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Unary `-` is not supported on `numpy.bool[builtins.bool]`\n  Object of class `bool` has no attribute `__neg__`",
      "concise_description": "Unary `-` is not supported on `numpy.bool[builtins.bool]`",
      "severity": "error"
    },
    {
      "line": 423,
      "column": 39,
      "stop_line": 430,
      "stop_column": 14,
      "path": "lib/marin/src/marin/post_training/flax/train.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`dict[str, Any] | dict[Unknown, Unknown] | Unknown` is not assignable to `TrainState`",
      "concise_description": "`dict[str, Any] | dict[Unknown, Unknown] | Unknown` is not assignable to `TrainState`",
      "severity": "error"
    },
    {
      "line": 142,
      "column": 26,
      "stop_line": 142,
      "stop_column": 40,
      "path": "lib/marin/src/marin/post_training/flax/utils.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `_EmptyNode`",
      "concise_description": "Expected a callable, got `_EmptyNode`",
      "severity": "error"
    },
    {
      "line": 168,
      "column": 25,
      "stop_line": 168,
      "stop_column": 40,
      "path": "lib/marin/src/marin/post_training/flax/utils.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `_EmptyNode`",
      "concise_description": "Expected a callable, got `_EmptyNode`",
      "severity": "error"
    },
    {
      "line": 220,
      "column": 20,
      "stop_line": 220,
      "stop_column": 36,
      "path": "lib/marin/src/marin/post_training/flax/utils.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `jax.flatten_util` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `jax.flatten_util` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 301,
      "column": 34,
      "stop_line": 301,
      "stop_column": 38,
      "path": "lib/marin/src/marin/post_training/flax/utils.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to attribute `config_to_log` with type `dict[Unknown, Unknown]`",
      "concise_description": "`None` is not assignable to attribute `config_to_log` with type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 319,
      "column": 24,
      "stop_line": 319,
      "stop_column": 28,
      "path": "lib/marin/src/marin/post_training/flax/utils.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to attribute `run` with type `Run`",
      "concise_description": "`None` is not assignable to attribute `run` with type `Run`",
      "severity": "error"
    },
    {
      "line": 137,
      "column": 35,
      "stop_line": 137,
      "stop_column": 40,
      "path": "lib/marin/src/marin/processing/classification/autoscaler.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `BoundMethod[DefaultContext, (self: DefaultContext) -> Event]`",
      "concise_description": "Expected a type form, got instance of `BoundMethod[DefaultContext, (self: DefaultContext) -> Event]`",
      "severity": "error"
    },
    {
      "line": 141,
      "column": 36,
      "stop_line": 141,
      "stop_column": 41,
      "path": "lib/marin/src/marin/processing/classification/autoscaler.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `BoundMethod[DefaultContext, (self: DefaultContext) -> Event]`",
      "concise_description": "Expected a type form, got instance of `BoundMethod[DefaultContext, (self: DefaultContext) -> Event]`",
      "severity": "error"
    },
    {
      "line": 145,
      "column": 34,
      "stop_line": 145,
      "stop_column": 39,
      "path": "lib/marin/src/marin/processing/classification/autoscaler.py",
      "code": -2,
      "name": "not-a-type",
      "description": "Expected a type form, got instance of `BoundMethod[DefaultContext, (self: DefaultContext) -> Event]`",
      "concise_description": "Expected a type form, got instance of `BoundMethod[DefaultContext, (self: DefaultContext) -> Event]`",
      "severity": "error"
    },
    {
      "line": 250,
      "column": 32,
      "stop_line": 250,
      "stop_column": 46,
      "path": "lib/marin/src/marin/processing/classification/autoscaler.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `ray.exceptions` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `ray.exceptions` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 23,
      "column": 12,
      "stop_line": 23,
      "stop_column": 15,
      "path": "lib/marin/src/marin/processing/classification/checkpoint_utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[Unknown, Unknown] | Unknown` is not assignable to declared return type `str | None`",
      "concise_description": "Returned type `dict[Unknown, Unknown] | Unknown` is not assignable to declared return type `str | None`",
      "severity": "error"
    },
    {
      "line": 59,
      "column": 9,
      "stop_line": 59,
      "stop_column": 16,
      "path": "lib/marin/src/marin/processing/classification/classifier.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `DummyClassifier.predict` overrides parent class `BaseClassifier` in an inconsistent manner\n  `DummyClassifier.predict` has type `BoundMethod[DummyClassifier, (self: DummyClassifier, documents: list[str]) -> list[dict[str, float]]]`, which is not assignable to `BoundMethod[DummyClassifier, (self: DummyClassifier, documents: list[str]) -> Never]`, the type of `BaseClassifier.predict`",
      "concise_description": "Class member `DummyClassifier.predict` overrides parent class `BaseClassifier` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 90,
      "column": 41,
      "stop_line": 90,
      "stop_column": 121,
      "path": "lib/marin/src/marin/processing/classification/classifier.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`bool | str` is not assignable to `bool`",
      "concise_description": "`bool | str` is not assignable to `bool`",
      "severity": "error"
    },
    {
      "line": 195,
      "column": 9,
      "stop_line": 195,
      "stop_column": 16,
      "path": "lib/marin/src/marin/processing/classification/classifier.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `BERTClassifier.predict` overrides parent class `BaseClassifier` in an inconsistent manner\n  `BERTClassifier.predict` has type `BoundMethod[BERTClassifier, (self: BERTClassifier, documents: list[str]) -> list[float]]`, which is not assignable to `BoundMethod[BERTClassifier, (self: BERTClassifier, documents: list[str]) -> Never]`, the type of `BaseClassifier.predict`",
      "concise_description": "Class member `BERTClassifier.predict` overrides parent class `BaseClassifier` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 243,
      "column": 9,
      "stop_line": 243,
      "stop_column": 16,
      "path": "lib/marin/src/marin/processing/classification/classifier.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `BERTQualityClassifier.predict` overrides parent class `BaseClassifier` in an inconsistent manner\n  `BERTQualityClassifier.predict` has type `BoundMethod[BERTQualityClassifier, (self: BERTQualityClassifier, documents: list[str]) -> list[float]]`, which is not assignable to `BoundMethod[BERTQualityClassifier, (self: BERTQualityClassifier, documents: list[str]) -> Never]`, the type of `BaseClassifier.predict`",
      "concise_description": "Class member `BERTQualityClassifier.predict` overrides parent class `BaseClassifier` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 279,
      "column": 30,
      "stop_line": 279,
      "stop_column": 100,
      "path": "lib/marin/src/marin/processing/classification/classifier.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`bool | str` is not assignable to `bool`",
      "concise_description": "`bool | str` is not assignable to `bool`",
      "severity": "error"
    },
    {
      "line": 561,
      "column": 57,
      "stop_line": 561,
      "stop_column": 77,
      "path": "lib/marin/src/marin/processing/classification/classifier.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `str`",
      "concise_description": "Expected a callable, got `str`",
      "severity": "error"
    },
    {
      "line": 572,
      "column": 68,
      "stop_line": 581,
      "stop_column": 6,
      "path": "lib/marin/src/marin/processing/classification/classifier.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`dict[str, type[BERTQualityClassifier] | type[CompressionClassifier] | type[DummyClassifier] | type[FasttextClassifier] | type[FinewebEduClassifier] | type[GTEClassifier] | type[vLLMClassifier] | type[vLLMClassifierWithDocsAndAttributes]]` is not assignable to `dict[str, BaseClassifier]`",
      "concise_description": "`dict[str, type[BERTQualityClassifier] | type[CompressionClassifier] | type[DummyClassifier] | type[FasttextClassifier] | type[FinewebEduClassifier] | type[GTEClassifier] | type[vLLMClassifier] | type[vLLMClassifierWithDocsAndAttributes]]` is not assignable to `dict[str, BaseClassifier]`",
      "severity": "error"
    },
    {
      "line": 187,
      "column": 12,
      "stop_line": 187,
      "stop_column": 55,
      "path": "lib/marin/src/marin/processing/classification/consolidate.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[str, str] | str` is not assignable to declared return type `str`",
      "concise_description": "Returned type `dict[str, str] | str` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 251,
      "column": 14,
      "stop_line": 251,
      "stop_column": 20,
      "path": "lib/marin/src/marin/processing/classification/consolidate.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, Any]`\n  Argument `Mapping[Unknown, Unknown] | dict[Unknown, Unknown] | list[Unknown] | Unknown` is not assignable to parameter `key` with type `str` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, Any]`",
      "severity": "error"
    },
    {
      "line": 356,
      "column": 12,
      "stop_line": 356,
      "stop_column": 21,
      "path": "lib/marin/src/marin/processing/classification/consolidate.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `Literal[0] | Unknown | None` is not assignable to declared return type `float`",
      "concise_description": "Returned type `Literal[0] | Unknown | None` is not assignable to declared return type `float`",
      "severity": "error"
    },
    {
      "line": 116,
      "column": 39,
      "stop_line": 116,
      "stop_column": 49,
      "path": "lib/marin/src/marin/processing/classification/dataset_utils.py",
      "code": -2,
      "name": "bad-specialization",
      "description": "`Buffer` is not assignable to upper bound `bytes | str` of type variable `AnyStr`",
      "concise_description": "`Buffer` is not assignable to upper bound `bytes | str` of type variable `AnyStr`",
      "severity": "error"
    },
    {
      "line": 138,
      "column": 32,
      "stop_line": 138,
      "stop_column": 38,
      "path": "lib/marin/src/marin/processing/classification/dedupe.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, bool | int]`\n  Argument `list[Unknown]` is not assignable to parameter `value` with type `bool | int` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, bool | int]`",
      "severity": "error"
    },
    {
      "line": 997,
      "column": 39,
      "stop_line": 997,
      "stop_column": 55,
      "path": "lib/marin/src/marin/processing/classification/dedupe.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, int]`\n  Argument `dict[str, float]` is not assignable to parameter `value` with type `int` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, int]`",
      "severity": "error"
    },
    {
      "line": 244,
      "column": 15,
      "stop_line": 244,
      "stop_column": 49,
      "path": "lib/marin/src/marin/processing/classification/inference.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`>=` is not supported between `int` and `None`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__ge__`",
      "concise_description": "`>=` is not supported between `int` and `None`",
      "severity": "error"
    },
    {
      "line": 93,
      "column": 5,
      "stop_line": 93,
      "stop_column": 15,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `TokenizeConfig.cache_path` overrides parent class `TokenizeConfigBase` in an inconsistent manner\n  `TokenizeConfig.cache_path` is read-only, but `TokenizeConfigBase.cache_path` is read-write",
      "concise_description": "Class member `TokenizeConfig.cache_path` overrides parent class `TokenizeConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 94,
      "column": 5,
      "stop_line": 94,
      "stop_column": 14,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `TokenizeConfig.tokenizer` overrides parent class `TokenizeConfigBase` in an inconsistent manner\n  `TokenizeConfig.tokenizer` is read-only, but `TokenizeConfigBase.tokenizer` is read-write",
      "concise_description": "Class member `TokenizeConfig.tokenizer` overrides parent class `TokenizeConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 96,
      "column": 5,
      "stop_line": 96,
      "stop_column": 18,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `TokenizeConfig.cache_options` overrides parent class `TokenizeConfigBase` in an inconsistent manner\n  `TokenizeConfig.cache_options` is read-only, but `TokenizeConfigBase.cache_options` is read-write",
      "concise_description": "Class member `TokenizeConfig.cache_options` overrides parent class `TokenizeConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 97,
      "column": 5,
      "stop_line": 97,
      "stop_column": 11,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `TokenizeConfig.format` overrides parent class `TokenizeConfigBase` in an inconsistent manner\n  `TokenizeConfig.format` is read-only, but `TokenizeConfigBase.format` is read-write",
      "concise_description": "Class member `TokenizeConfig.format` overrides parent class `TokenizeConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 182,
      "column": 5,
      "stop_line": 182,
      "stop_column": 15,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `HfTokenizeConfig.cache_path` overrides parent class `TokenizeConfigBase` in an inconsistent manner\n  `HfTokenizeConfig.cache_path` is read-only, but `TokenizeConfigBase.cache_path` is read-write",
      "concise_description": "Class member `HfTokenizeConfig.cache_path` overrides parent class `TokenizeConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 183,
      "column": 5,
      "stop_line": 183,
      "stop_column": 14,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `HfTokenizeConfig.tokenizer` overrides parent class `TokenizeConfigBase` in an inconsistent manner\n  `HfTokenizeConfig.tokenizer` is read-only, but `TokenizeConfigBase.tokenizer` is read-write",
      "concise_description": "Class member `HfTokenizeConfig.tokenizer` overrides parent class `TokenizeConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 186,
      "column": 5,
      "stop_line": 186,
      "stop_column": 18,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `HfTokenizeConfig.cache_options` overrides parent class `TokenizeConfigBase` in an inconsistent manner\n  `HfTokenizeConfig.cache_options` is read-only, but `TokenizeConfigBase.cache_options` is read-write",
      "concise_description": "Class member `HfTokenizeConfig.cache_options` overrides parent class `TokenizeConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 187,
      "column": 5,
      "stop_line": 187,
      "stop_column": 11,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `HfTokenizeConfig.format` overrides parent class `TokenizeConfigBase` in an inconsistent manner\n  `HfTokenizeConfig.format` is read-only, but `TokenizeConfigBase.format` is read-write",
      "concise_description": "Class member `HfTokenizeConfig.format` overrides parent class `TokenizeConfigBase` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 403,
      "column": 5,
      "stop_line": 403,
      "stop_column": 13,
      "path": "lib/marin/src/marin/processing/tokenize/tokenize.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `RemoteFunction0[None, TokenizeConfigBase]`",
      "concise_description": "Expected a callable, got `RemoteFunction0[None, TokenizeConfigBase]`",
      "severity": "error"
    },
    {
      "line": 300,
      "column": 50,
      "stop_line": 300,
      "stop_column": 54,
      "path": "lib/marin/src/marin/raw2json/huggingface/qa/raw2json.py",
      "code": -2,
      "name": "bad-return",
      "description": "Function declared to return `list[Unknown]`, but one or more paths are missing an explicit `return`",
      "concise_description": "Function declared to return `list[Unknown]`, but one or more paths are missing an explicit `return`",
      "severity": "error"
    },
    {
      "line": 67,
      "column": 19,
      "stop_line": 67,
      "stop_column": 69,
      "path": "lib/marin/src/marin/resources.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`|` is not supported between `None` and `dict[str, str]`\n  No matching overload found for function `dict.__ror__` called with arguments: (None)\n  Possible overloads:\n  (value: dict[str, str], /) -> dict[str, str] [closest match]\n  (value: dict[_T1, _T2], /) -> dict[str | _T1, str | _T2]",
      "concise_description": "`|` is not supported between `None` and `dict[str, str]`",
      "severity": "error"
    },
    {
      "line": 87,
      "column": 21,
      "stop_line": 87,
      "stop_column": 88,
      "path": "lib/marin/src/marin/resources.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`int | None` is not assignable to `int`",
      "concise_description": "`int | None` is not assignable to `int`",
      "severity": "error"
    },
    {
      "line": 90,
      "column": 5,
      "stop_line": 90,
      "stop_column": 16,
      "path": "lib/marin/src/marin/resources.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `CpuOnlyConfig.runtime_env` overrides parent class `ResourceConfig` in an inconsistent manner\n  `CpuOnlyConfig.runtime_env` is read-only, but `ResourceConfig.runtime_env` is read-write",
      "concise_description": "Class member `CpuOnlyConfig.runtime_env` overrides parent class `ResourceConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 92,
      "column": 5,
      "stop_line": 92,
      "stop_column": 26,
      "path": "lib/marin/src/marin/resources.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `CpuOnlyConfig.device_flops_override` overrides parent class `ResourceConfig` in an inconsistent manner\n  `CpuOnlyConfig.device_flops_override` is read-only, but `ResourceConfig.device_flops_override` is read-write",
      "concise_description": "Class member `CpuOnlyConfig.device_flops_override` overrides parent class `ResourceConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 124,
      "column": 5,
      "stop_line": 124,
      "stop_column": 16,
      "path": "lib/marin/src/marin/resources.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `GpuConfig.runtime_env` overrides parent class `ResourceConfig` in an inconsistent manner\n  `GpuConfig.runtime_env` is read-only, but `ResourceConfig.runtime_env` is read-write",
      "concise_description": "Class member `GpuConfig.runtime_env` overrides parent class `ResourceConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 132,
      "column": 5,
      "stop_line": 132,
      "stop_column": 26,
      "path": "lib/marin/src/marin/resources.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `GpuConfig.device_flops_override` overrides parent class `ResourceConfig` in an inconsistent manner\n  `GpuConfig.device_flops_override` is read-only, but `ResourceConfig.device_flops_override` is read-write",
      "concise_description": "Class member `GpuConfig.device_flops_override` overrides parent class `ResourceConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 204,
      "column": 5,
      "stop_line": 204,
      "stop_column": 16,
      "path": "lib/marin/src/marin/resources.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `TpuPodConfig.runtime_env` overrides parent class `ResourceConfig` in an inconsistent manner\n  `TpuPodConfig.runtime_env` is read-only, but `ResourceConfig.runtime_env` is read-write",
      "concise_description": "Class member `TpuPodConfig.runtime_env` overrides parent class `ResourceConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 206,
      "column": 5,
      "stop_line": 206,
      "stop_column": 26,
      "path": "lib/marin/src/marin/resources.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `TpuPodConfig.device_flops_override` overrides parent class `ResourceConfig` in an inconsistent manner\n  `TpuPodConfig.device_flops_override` is read-only, but `ResourceConfig.device_flops_override` is read-write",
      "concise_description": "Class member `TpuPodConfig.device_flops_override` overrides parent class `ResourceConfig` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 268,
      "column": 12,
      "stop_line": 268,
      "stop_column": 35,
      "path": "lib/marin/src/marin/rl/evaluate_environment.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `list[Unknown]` is not assignable to declared return type `dict[str, Any]`",
      "concise_description": "Returned type `list[Unknown]` is not assignable to declared return type `dict[str, Any]`",
      "severity": "error"
    },
    {
      "line": 100,
      "column": 25,
      "stop_line": 100,
      "stop_column": 57,
      "path": "lib/marin/src/marin/rl/math_utils.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+` is not supported between `None` and `Literal[1]`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__radd__`",
      "concise_description": "`+` is not supported between `None` and `Literal[1]`",
      "severity": "error"
    },
    {
      "line": 561,
      "column": 13,
      "stop_line": 561,
      "stop_column": 21,
      "path": "lib/marin/src/marin/rl/math_utils.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`float` is not assignable to variable `x` with type `str`",
      "concise_description": "`float` is not assignable to variable `x` with type `str`",
      "severity": "error"
    },
    {
      "line": 597,
      "column": 16,
      "stop_line": 597,
      "stop_column": 20,
      "path": "lib/marin/src/marin/rl/math_utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `None` is not assignable to declared return type `str`",
      "concise_description": "Returned type `None` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 95,
      "column": 16,
      "stop_line": 95,
      "stop_column": 21,
      "path": "lib/marin/src/marin/rl/model_utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `ModelWithHfSerializationMixin[Unknown]` is not assignable to declared return type `LmHeadModel`",
      "concise_description": "Returned type `ModelWithHfSerializationMixin[Unknown]` is not assignable to declared return type `LmHeadModel`",
      "severity": "error"
    },
    {
      "line": 177,
      "column": 16,
      "stop_line": 177,
      "stop_column": 20,
      "path": "lib/marin/src/marin/rl/rl_losses.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `Self@RLOOLoss` is not assignable to declared return type `Module`",
      "concise_description": "Returned type `Self@RLOOLoss` is not assignable to declared return type `Module`",
      "severity": "error"
    },
    {
      "line": 181,
      "column": 16,
      "stop_line": 181,
      "stop_column": 54,
      "path": "lib/marin/src/marin/rl/rl_losses.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `ndarray[tuple[Any, ...], dtype[Any]]` is not assignable to declared return type `list[float]`",
      "concise_description": "Returned type `ndarray[tuple[Any, ...], dtype[Any]]` is not assignable to declared return type `list[float]`",
      "severity": "error"
    },
    {
      "line": 199,
      "column": 15,
      "stop_line": 199,
      "stop_column": 49,
      "path": "lib/marin/src/marin/rl/rollout_storage.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`<` is not supported between `float` and `None`\n  Argument `None` is not assignable to parameter `value` with type `float` in function `float.__lt__`",
      "concise_description": "`<` is not supported between `float` and `None`",
      "severity": "error"
    },
    {
      "line": 398,
      "column": 16,
      "stop_line": 398,
      "stop_column": 21,
      "path": "lib/marin/src/marin/rl/rollout_worker.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `RolloutBatchStats` is not assignable to declared return type `dict[Unknown, Unknown]`",
      "concise_description": "Returned type `RolloutBatchStats` is not assignable to declared return type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 400,
      "column": 55,
      "stop_line": 400,
      "stop_column": 59,
      "path": "lib/marin/src/marin/rl/rollout_worker.py",
      "code": -2,
      "name": "bad-return",
      "description": "Function declared to return `dict[Unknown, Unknown]`, but one or more paths are missing an explicit `return`",
      "concise_description": "Function declared to return `dict[Unknown, Unknown]`, but one or more paths are missing an explicit `return`",
      "severity": "error"
    },
    {
      "line": 197,
      "column": 6,
      "stop_line": 197,
      "stop_column": 20,
      "path": "lib/marin/src/marin/rl/scripts/replay_completions.py",
      "code": -2,
      "name": "bad-return",
      "description": "Function declared to return `dict[str, Any]`, but one or more paths are missing an explicit `return`",
      "concise_description": "Function declared to return `dict[str, Any]`, but one or more paths are missing an explicit `return`",
      "severity": "error"
    },
    {
      "line": 69,
      "column": 16,
      "stop_line": 69,
      "stop_column": 33,
      "path": "lib/marin/src/marin/rl/weight_transfer/__init__.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 98,
      "column": 16,
      "stop_line": 98,
      "stop_column": 33,
      "path": "lib/marin/src/marin/rl/weight_transfer/__init__.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 181,
      "column": 5,
      "stop_line": 187,
      "stop_column": 53,
      "path": "lib/marin/src/marin/rl/weight_transfer/arrow_flight.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`tuple[Unknown, ...] | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`tuple[Unknown, ...] | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 216,
      "column": 29,
      "stop_line": 216,
      "stop_column": 33,
      "path": "lib/marin/src/marin/rl/weight_transfer/arrow_flight.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to attribute `_server_info` with type `type[ServerInfo | None]`",
      "concise_description": "`None` is not assignable to attribute `_server_info` with type `type[ServerInfo | None]`",
      "severity": "error"
    },
    {
      "line": 219,
      "column": 29,
      "stop_line": 223,
      "stop_column": 10,
      "path": "lib/marin/src/marin/rl/weight_transfer/arrow_flight.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`ServerInfo` is not assignable to attribute `_server_info` with type `type[ServerInfo | None]`",
      "concise_description": "`ServerInfo` is not assignable to attribute `_server_info` with type `type[ServerInfo | None]`",
      "severity": "error"
    },
    {
      "line": 225,
      "column": 16,
      "stop_line": 225,
      "stop_column": 19,
      "path": "lib/marin/src/marin/rl/weight_transfer/arrow_flight.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `Literal[123]` is not assignable to declared return type `None`",
      "concise_description": "Returned type `Literal[123]` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 228,
      "column": 16,
      "stop_line": 228,
      "stop_column": 33,
      "path": "lib/marin/src/marin/rl/weight_transfer/arrow_flight.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `type[ServerInfo | None]` is not assignable to declared return type `ServerInfo`",
      "concise_description": "Returned type `type[ServerInfo | None]` is not assignable to declared return type `ServerInfo`",
      "severity": "error"
    },
    {
      "line": 436,
      "column": 9,
      "stop_line": 436,
      "stop_column": 20,
      "path": "lib/marin/src/marin/rl/weight_transfer/arrow_flight.py",
      "code": -2,
      "name": "bad-override",
      "description": "Class member `ArrowFlightServer.get_metrics` overrides parent class `WeightTransferServer` in an inconsistent manner\n  `ArrowFlightServer.get_metrics` has type `BoundMethod[ArrowFlightServer, (self: ArrowFlightServer) -> WeightTransferServerMetrics]`, which is not assignable to `BoundMethod[ArrowFlightServer, (self: ArrowFlightServer) -> dict[Unknown, Unknown]]`, the type of `WeightTransferServer.get_metrics`",
      "concise_description": "Class member `ArrowFlightServer.get_metrics` overrides parent class `WeightTransferServer` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 502,
      "column": 24,
      "stop_line": 502,
      "stop_column": 33,
      "path": "lib/marin/src/marin/rl/weight_transfer/arrow_flight.py",
      "code": -2,
      "name": "implicit-import",
      "description": "Module `pyarrow.flight` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "concise_description": "Module `pyarrow.flight` exists, but was not imported explicitly. You are relying on other modules to load it.",
      "severity": "error"
    },
    {
      "line": 566,
      "column": 36,
      "stop_line": 566,
      "stop_column": 57,
      "path": "lib/marin/src/marin/rl/weight_transfer/arrow_flight.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`object | Unknown` is not assignable to attribute `_last_weight_id` with type `int | None`",
      "concise_description": "`object | Unknown` is not assignable to attribute `_last_weight_id` with type `int | None`",
      "severity": "error"
    },
    {
      "line": 142,
      "column": 40,
      "stop_line": 142,
      "stop_column": 63,
      "path": "lib/marin/src/marin/rl/weight_transfer/jax.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`str` is not assignable to attribute `transfer_server_address` with type `None`",
      "concise_description": "`str` is not assignable to attribute `transfer_server_address` with type `None`",
      "severity": "error"
    },
    {
      "line": 369,
      "column": 28,
      "stop_line": 369,
      "stop_column": 109,
      "path": "lib/marin/src/marin/rl/weight_transfer/jax.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`RobustActor` is not assignable to attribute `coordinator` with type `WeightTransferCoordinator`",
      "concise_description": "`RobustActor` is not assignable to attribute `coordinator` with type `WeightTransferCoordinator`",
      "severity": "error"
    },
    {
      "line": 444,
      "column": 32,
      "stop_line": 444,
      "stop_column": 36,
      "path": "lib/marin/src/marin/rl/weight_transfer/jax.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to attribute `transfer_server` with type `TransferServer`",
      "concise_description": "`None` is not assignable to attribute `transfer_server` with type `TransferServer`",
      "severity": "error"
    },
    {
      "line": 552,
      "column": 32,
      "stop_line": 552,
      "stop_column": 36,
      "path": "lib/marin/src/marin/rl/weight_transfer/jax.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`None` is not assignable to attribute `transfer_server` with type `TransferServer`",
      "concise_description": "`None` is not assignable to attribute `transfer_server` with type `TransferServer`",
      "severity": "error"
    },
    {
      "line": 49,
      "column": 13,
      "stop_line": 49,
      "stop_column": 23,
      "path": "lib/marin/src/marin/run/ray_deps.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`set[str]` is not assignable to variable `extra` with type `list[str] | None`",
      "concise_description": "`set[str]` is not assignable to variable `extra` with type `list[str] | None`",
      "severity": "error"
    },
    {
      "line": 68,
      "column": 13,
      "stop_line": 68,
      "stop_column": 23,
      "path": "lib/marin/src/marin/run/ray_deps.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`set[str]` is not assignable to variable `extra` with type `list[str] | None`",
      "concise_description": "`set[str]` is not assignable to variable `extra` with type `list[str] | None`",
      "severity": "error"
    },
    {
      "line": 196,
      "column": 12,
      "stop_line": 199,
      "stop_column": 6,
      "path": "lib/marin/src/marin/run/ray_deps.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[str, dict[str, str] | dict[Unknown, Unknown]]` is not assignable to declared return type `RuntimeEnv`",
      "concise_description": "Returned type `dict[str, dict[str, str] | dict[Unknown, Unknown]]` is not assignable to declared return type `RuntimeEnv`",
      "severity": "error"
    },
    {
      "line": 95,
      "column": 12,
      "stop_line": 95,
      "stop_column": 21,
      "path": "lib/marin/src/marin/scaling_laws/utils.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 208,
      "column": 5,
      "stop_line": 208,
      "stop_column": 12,
      "path": "lib/marin/src/marin/scaling_laws/utils.py",
      "code": -2,
      "name": "bad-unpacking",
      "description": "Cannot unpack tuple[Unknown, ndarray[tuple[int, int], dtype[Any]] | Unknown] | tuple[Unknown, ndarray[tuple[int, int], dtype[Any]] | Unknown, dict[str, Unknown] | Unknown, Unknown, Literal[1, 2, 3, 4] | Unknown] (of size 5) into 2 values",
      "concise_description": "Cannot unpack tuple[Unknown, ndarray[tuple[int, int], dtype[Any]] | Unknown] | tuple[Unknown, ndarray[tuple[int, int], dtype[Any]] | Unknown, dict[str, Unknown] | Unknown, Unknown, Literal[1, 2, 3, 4] | Unknown] (of size 5) into 2 values",
      "severity": "error"
    },
    {
      "line": 314,
      "column": 12,
      "stop_line": 314,
      "stop_column": 19,
      "path": "lib/marin/src/marin/scaling_laws/utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown, ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown, ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown | None]` is not assignable to declared return type `tuple[ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]]]`",
      "concise_description": "Returned type `tuple[ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown, ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown, ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown | None]` is not assignable to declared return type `tuple[ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]]]`",
      "severity": "error"
    },
    {
      "line": 428,
      "column": 12,
      "stop_line": 428,
      "stop_column": 15,
      "path": "lib/marin/src/marin/scaling_laws/utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `Module[matplotlib.pyplot]` is not assignable to declared return type `None`",
      "concise_description": "Returned type `Module[matplotlib.pyplot]` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 469,
      "column": 12,
      "stop_line": 469,
      "stop_column": 15,
      "path": "lib/marin/src/marin/scaling_laws/utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `Module[matplotlib.pyplot]` is not assignable to declared return type `None`",
      "concise_description": "Returned type `Module[matplotlib.pyplot]` is not assignable to declared return type `None`",
      "severity": "error"
    },
    {
      "line": 685,
      "column": 12,
      "stop_line": 685,
      "stop_column": 36,
      "path": "lib/marin/src/marin/scaling_laws/utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[dict[str, ndarray[tuple[Any, ...], dtype[Any]]], tuple[dict[Unknown, Unknown], dict[Unknown, Unknown], ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown, ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown] | None]` is not assignable to declared return type `tuple[dict[str, ndarray[tuple[Any, ...], dtype[Any]]], tuple[dict[Unknown, Unknown], dict[Unknown, Unknown], ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]]] | None]`",
      "concise_description": "Returned type `tuple[dict[str, ndarray[tuple[Any, ...], dtype[Any]]], tuple[dict[Unknown, Unknown], dict[Unknown, Unknown], ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown, ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]] | Unknown] | None]` is not assignable to declared return type `tuple[dict[str, ndarray[tuple[Any, ...], dtype[Any]]], tuple[dict[Unknown, Unknown], dict[Unknown, Unknown], ndarray[tuple[Any, ...], dtype[Any]], ndarray[tuple[Any, ...], dtype[Any]]] | None]`",
      "severity": "error"
    },
    {
      "line": 97,
      "column": 61,
      "stop_line": 97,
      "stop_column": 85,
      "path": "lib/marin/src/marin/speedrun/speedrun.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`ExecutorStep[PretokenizedCacheDownloadConfig]` is not assignable to `InputName | LMMixtureDatasetConfig`",
      "concise_description": "`ExecutorStep[PretokenizedCacheDownloadConfig]` is not assignable to `InputName | LMMixtureDatasetConfig`",
      "severity": "error"
    },
    {
      "line": 140,
      "column": 36,
      "stop_line": 140,
      "stop_column": 50,
      "path": "lib/marin/src/marin/speedrun/speedrun.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`/` is not supported between `None` and `float`\n  Argument `None` is not assignable to parameter `value` with type `float` in function `float.__rtruediv__`",
      "concise_description": "`/` is not supported between `None` and `float`",
      "severity": "error"
    },
    {
      "line": 159,
      "column": 9,
      "stop_line": 159,
      "stop_column": 29,
      "path": "lib/marin/src/marin/speedrun/speedrun.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`*=` is not supported between `None` and `Literal[3]`\n  Argument `None` is not assignable to parameter `value` with type `int` in function `int.__rmul__`",
      "concise_description": "`*=` is not supported between `None` and `Literal[3]`",
      "severity": "error"
    },
    {
      "line": 178,
      "column": 16,
      "stop_line": 178,
      "stop_column": 58,
      "path": "lib/marin/src/marin/speedrun/speedrun.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `float | None` is not assignable to declared return type `float`",
      "concise_description": "Returned type `float | None` is not assignable to declared return type `float`",
      "severity": "error"
    },
    {
      "line": 56,
      "column": 23,
      "stop_line": 56,
      "stop_column": 39,
      "path": "lib/marin/src/marin/tokenize/slice_cache.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`OutputName` is not assignable to `str`",
      "concise_description": "`OutputName` is not assignable to `str`",
      "severity": "error"
    },
    {
      "line": 211,
      "column": 74,
      "stop_line": 211,
      "stop_column": 104,
      "path": "lib/marin/src/marin/tokenize/slice_cache.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`+` is not supported between `None` and `list[str]`\n  Cannot find `__add__` or `__radd__`",
      "concise_description": "`+` is not supported between `None` and `list[str]`",
      "severity": "error"
    },
    {
      "line": 317,
      "column": 15,
      "stop_line": 317,
      "stop_column": 48,
      "path": "lib/marin/src/marin/training/training.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`MutableMapping[Unknown, Unknown]` is not assignable to variable `env` with type `dict[Unknown, Unknown]`",
      "concise_description": "`MutableMapping[Unknown, Unknown]` is not assignable to variable `env` with type `dict[Unknown, Unknown]`",
      "severity": "error"
    },
    {
      "line": 89,
      "column": 12,
      "stop_line": 89,
      "stop_column": 46,
      "path": "lib/marin/src/marin/transform/ar5iv/transform_ar5iv.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`BeautifulSoup` is not assignable to variable `html` with type `str`",
      "concise_description": "`BeautifulSoup` is not assignable to variable `html` with type `str`",
      "severity": "error"
    },
    {
      "line": 122,
      "column": 12,
      "stop_line": 122,
      "stop_column": 28,
      "path": "lib/marin/src/marin/transform/ar5iv/transform_ar5iv.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`BeautifulSoup` is not assignable to variable `html` with type `str`",
      "concise_description": "`BeautifulSoup` is not assignable to variable `html` with type `str`",
      "severity": "error"
    },
    {
      "line": 116,
      "column": 9,
      "stop_line": 141,
      "stop_column": 30,
      "path": "lib/marin/src/marin/transform/common_pile/filter_by_extension.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`list[Unknown] | Unknown | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "concise_description": "`list[Unknown] | Unknown | None` is not assignable to `None` (caused by inconsistent types when breaking cycles)",
      "severity": "error"
    },
    {
      "line": 62,
      "column": 5,
      "stop_line": 62,
      "stop_column": 29,
      "path": "lib/marin/src/marin/transform/conversation/adapters.py",
      "code": -2,
      "name": "invalid-annotation",
      "description": "Enum member `SINGLE_COLUMN_MULTI_TURN` may not be annotated directly. Instead, annotate the `_value_` attribute.",
      "concise_description": "Enum member `SINGLE_COLUMN_MULTI_TURN` may not be annotated directly. Instead, annotate the `_value_` attribute.",
      "severity": "error"
    },
    {
      "line": 63,
      "column": 5,
      "stop_line": 63,
      "stop_column": 25,
      "path": "lib/marin/src/marin/transform/conversation/adapters.py",
      "code": -2,
      "name": "invalid-annotation",
      "description": "Enum member `INSTRUCTION_RESPONSE` may not be annotated directly. Instead, annotate the `_value_` attribute.",
      "concise_description": "Enum member `INSTRUCTION_RESPONSE` may not be annotated directly. Instead, annotate the `_value_` attribute.",
      "severity": "error"
    },
    {
      "line": 64,
      "column": 5,
      "stop_line": 64,
      "stop_column": 29,
      "path": "lib/marin/src/marin/transform/conversation/adapters.py",
      "code": -2,
      "name": "invalid-annotation",
      "description": "Enum member `INSTRUCT_COLUMN_RESPONSE` may not be annotated directly. Instead, annotate the `_value_` attribute.",
      "concise_description": "Enum member `INSTRUCT_COLUMN_RESPONSE` may not be annotated directly. Instead, annotate the `_value_` attribute.",
      "severity": "error"
    },
    {
      "line": 65,
      "column": 5,
      "stop_line": 65,
      "stop_column": 26,
      "path": "lib/marin/src/marin/transform/conversation/adapters.py",
      "code": -2,
      "name": "invalid-annotation",
      "description": "Enum member `INSTRUCT_MSG_RESPONSE` may not be annotated directly. Instead, annotate the `_value_` attribute.",
      "concise_description": "Enum member `INSTRUCT_MSG_RESPONSE` may not be annotated directly. Instead, annotate the `_value_` attribute.",
      "severity": "error"
    },
    {
      "line": 108,
      "column": 24,
      "stop_line": 108,
      "stop_column": 28,
      "path": "lib/marin/src/marin/transform/conversation/adapters.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `None` is not assignable to declared return type `list[OpenAIChatMessage]`",
      "concise_description": "Returned type `None` is not assignable to declared return type `list[OpenAIChatMessage]`",
      "severity": "error"
    },
    {
      "line": 117,
      "column": 28,
      "stop_line": 117,
      "stop_column": 61,
      "path": "lib/marin/src/marin/transform/conversation/adapters.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "`None` is not subscriptable",
      "concise_description": "`None` is not subscriptable",
      "severity": "error"
    },
    {
      "line": 155,
      "column": 24,
      "stop_line": 155,
      "stop_column": 28,
      "path": "lib/marin/src/marin/transform/conversation/adapters.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `None` is not assignable to declared return type `list[OpenAIChatMessage]`",
      "concise_description": "Returned type `None` is not assignable to declared return type `list[OpenAIChatMessage]`",
      "severity": "error"
    },
    {
      "line": 29,
      "column": 24,
      "stop_line": 29,
      "stop_column": 40,
      "path": "lib/marin/src/marin/transform/conversation/conversation_to_dolma.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`OutputName` is not assignable to `str`",
      "concise_description": "`OutputName` is not assignable to `str`",
      "severity": "error"
    },
    {
      "line": 96,
      "column": 32,
      "stop_line": 96,
      "stop_column": 94,
      "path": "lib/marin/src/marin/transform/conversation/transform_conversation.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`list[dict[str, Any]]` is not assignable to variable `transformed_row_messages` with type `list[OpenAIChatMessage]`",
      "concise_description": "`list[dict[str, Any]]` is not assignable to variable `transformed_row_messages` with type `list[OpenAIChatMessage]`",
      "severity": "error"
    },
    {
      "line": 123,
      "column": 52,
      "stop_line": 123,
      "stop_column": 84,
      "path": "lib/marin/src/marin/transform/conversation/transform_conversation.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`DolmaConversationOutput | None` is not assignable to `DolmaConversationOutput`",
      "concise_description": "`DolmaConversationOutput | None` is not assignable to `DolmaConversationOutput`",
      "severity": "error"
    },
    {
      "line": 214,
      "column": 12,
      "stop_line": 214,
      "stop_column": 22,
      "path": "lib/marin/src/marin/transform/conversation/transform_conversation.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`\n  Protocol `PathLike` requires attribute `__fspath__`",
      "concise_description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`",
      "severity": "error"
    },
    {
      "line": 222,
      "column": 16,
      "stop_line": 222,
      "stop_column": 45,
      "path": "lib/marin/src/marin/transform/conversation/transform_conversation.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`\n  Protocol `PathLike` requires attribute `__fspath__`",
      "concise_description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`",
      "severity": "error"
    },
    {
      "line": 223,
      "column": 12,
      "stop_line": 223,
      "stop_column": 54,
      "path": "lib/marin/src/marin/transform/conversation/transform_conversation.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`\n  Protocol `PathLike` requires attribute `__fspath__`",
      "concise_description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`",
      "severity": "error"
    },
    {
      "line": 132,
      "column": 16,
      "stop_line": 132,
      "stop_column": 45,
      "path": "lib/marin/src/marin/transform/conversation/transform_preference_data.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`\n  Protocol `PathLike` requires attribute `__fspath__`",
      "concise_description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`",
      "severity": "error"
    },
    {
      "line": 136,
      "column": 12,
      "stop_line": 136,
      "stop_column": 54,
      "path": "lib/marin/src/marin/transform/conversation/transform_preference_data.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`\n  Protocol `PathLike` requires attribute `__fspath__`",
      "concise_description": "Returned type `str` is not assignable to declared return type `PathLike[Unknown]`",
      "severity": "error"
    },
    {
      "line": 127,
      "column": 12,
      "stop_line": 127,
      "stop_column": 46,
      "path": "lib/marin/src/marin/transform/wikipedia/transform_wikipedia.py",
      "code": -2,
      "name": "bad-assignment",
      "description": "`BeautifulSoup` is not assignable to variable `html` with type `str`",
      "concise_description": "`BeautifulSoup` is not assignable to variable `html` with type `str`",
      "severity": "error"
    },
    {
      "line": 201,
      "column": 16,
      "stop_line": 201,
      "stop_column": 20,
      "path": "lib/marin/src/marin/transform/wikipedia/transform_wikipedia.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `None` is not assignable to declared return type `str`",
      "concise_description": "Returned type `None` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 212,
      "column": 16,
      "stop_line": 212,
      "stop_column": 20,
      "path": "lib/marin/src/marin/transform/wikipedia/transform_wikipedia.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `None` is not assignable to declared return type `str`",
      "concise_description": "Returned type `None` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 74,
      "column": 16,
      "stop_line": 74,
      "stop_column": 26,
      "path": "lib/marin/src/marin/utilities/executor_utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `str | Any` is not assignable to declared return type `bool`",
      "concise_description": "Returned type `str | Any` is not assignable to declared return type `bool`",
      "severity": "error"
    },
    {
      "line": 27,
      "column": 9,
      "stop_line": 27,
      "stop_column": 16,
      "path": "lib/marin/src/marin/utilities/json_encoder.py",
      "code": -2,
      "name": "bad-param-name-override",
      "description": "Class member `CustomJsonEncoder.default` overrides parent class `JSONEncoder` in an inconsistent manner\n  Got parameter name `obj`, expected `o`",
      "concise_description": "Class member `CustomJsonEncoder.default` overrides parent class `JSONEncoder` in an inconsistent manner",
      "severity": "error"
    },
    {
      "line": 107,
      "column": 16,
      "stop_line": 107,
      "stop_column": 46,
      "path": "lib/marin/src/marin/utilities/storage_transfer_utils.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[str, str]` is not assignable to declared return type `str`",
      "concise_description": "Returned type `tuple[str, str]` is not assignable to declared return type `str`",
      "severity": "error"
    },
    {
      "line": 314,
      "column": 24,
      "stop_line": 314,
      "stop_column": 26,
      "path": "lib/marin/src/marin/utils.py",
      "code": -2,
      "name": "not-callable",
      "description": "Expected a callable, got `None`",
      "concise_description": "Expected a callable, got `None`",
      "severity": "error"
    },
    {
      "line": 63,
      "column": 16,
      "stop_line": 63,
      "stop_column": 48,
      "path": "lib/marin/src/marin/validation/check_equality.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[str, bool]` is not assignable to declared return type `tuple[str, bool, list[int]]`",
      "concise_description": "Returned type `tuple[str, bool]` is not assignable to declared return type `tuple[str, bool, list[int]]`",
      "severity": "error"
    },
    {
      "line": 66,
      "column": 16,
      "stop_line": 66,
      "stop_column": 48,
      "path": "lib/marin/src/marin/validation/check_equality.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `tuple[str, bool]` is not assignable to declared return type `tuple[str, bool, list[int]]`",
      "concise_description": "Returned type `tuple[str, bool]` is not assignable to declared return type `tuple[str, bool, list[int]]`",
      "severity": "error"
    },
    {
      "line": 73,
      "column": 12,
      "stop_line": 73,
      "stop_column": 15,
      "path": "lib/marin/src/marin/web/convert.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[str, str | None]` is not assignable to declared return type `dict[str, str]`",
      "concise_description": "Returned type `dict[str, str | None]` is not assignable to declared return type `dict[str, str]`",
      "severity": "error"
    },
    {
      "line": 131,
      "column": 12,
      "stop_line": 131,
      "stop_column": 15,
      "path": "lib/marin/src/marin/web/convert.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[str, str | Unknown | None]` is not assignable to declared return type `dict[str, str]`",
      "concise_description": "Returned type `dict[str, str | Unknown | None]` is not assignable to declared return type `dict[str, str]`",
      "severity": "error"
    },
    {
      "line": 189,
      "column": 12,
      "stop_line": 189,
      "stop_column": 15,
      "path": "lib/marin/src/marin/web/convert.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[str, str | Unknown | None]` is not assignable to declared return type `dict[str, str]`",
      "concise_description": "Returned type `dict[str, str | Unknown | None]` is not assignable to declared return type `dict[str, str]`",
      "severity": "error"
    },
    {
      "line": 205,
      "column": 30,
      "stop_line": 205,
      "stop_column": 39,
      "path": "lib/marin/src/marin/web/convert.py",
      "code": -2,
      "name": "unsupported-operation",
      "description": "Cannot set item in `dict[str, None]`\n  Argument `str` is not assignable to parameter `value` with type `None` in function `dict.__setitem__`",
      "concise_description": "Cannot set item in `dict[str, None]`",
      "severity": "error"
    },
    {
      "line": 222,
      "column": 12,
      "stop_line": 222,
      "stop_column": 15,
      "path": "lib/marin/src/marin/web/convert.py",
      "code": -2,
      "name": "bad-return",
      "description": "Returned type `dict[str, str | Unknown | None]` is not assignable to declared return type `dict[str, str]`",
      "concise_description": "Returned type `dict[str, str | Unknown | None]` is not assignable to declared return type `dict[str, str]`",
      "severity": "error"
    }
  ]
}
